!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports["avalon"]=b():a["avalon"]=b()}(this,function(){return function(a){function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}var b={};return c.m=a,c.c=b,c.p="",c(0)}([function(a,b,c){var d=c(86);c(8),c(88),c(90),c(98),c(71),c(103),d.onComponentDispose=c(78),a.exports=d},,,function(a,b,c){var g,d=c(4),e=Function(" return this")()||this,f={window:e,document:{createElement:Object,createElementNS:Object,contains:Boolean},root:{outerHTML:"x"},msie:0/0,browser:!1,modern:!0,avalonDiv:{},avalonFragment:null};e.avalon=d,e.location&&e.navigator&&e.window&&(g=e.document,f.browser=!0,f.document=g,f.root=g.documentElement,f.avalonDiv=g.createElement("div"),f.avalonFragment=g.createDocumentFragment(),e.VBArray?(f.msie=g.documentMode||(e.XMLHttpRequest?7:6),f.modern=f.msie>8):f.modern=!0),d.shadowCopy(d,f)},function(a){function c(a){return new c.init(a)}var d,e;c.init=function(a){this[0]=this.element=a},c.fn=c.prototype=c.init.prototype,c.shadowCopy=function(a,b){for(var c in b)a[c]=b[c];return a},d=/[^, ]+/g,e="object"==typeof console,c.shadowCopy(c,{noop:function(){},rword:d,inspect:{}.toString,ohasOwn:{}.hasOwnProperty,log:function(){e&&c.config.debug&&Function.apply.call(console.log,console,arguments)},warn:function(){if(e&&c.config.debug){var a=console.warn||console.log;Function.apply.call(a,console,arguments)}},error:function(a,b){throw(b||Error)(a)},oneObject:function(a,b){var c,e,f,g;for("string"==typeof a&&(a=a.match(d)||[]),c={},e=void 0!==b?b:1,f=0,g=a.length;g>f;f++)c[a[f]]=e;return c}}),a.exports=c},,function(a,b,c){function k(a,b,c){a[c.name]=d.parseExpr(c)}var l,d=c(4),e={},f=/([a-z\d])([A-Z]+)/g,g=/[-_][^-_]/g,h=/\d\.\d{4}/,i=/[-.*+?^${}()|[\]\/\\]/g,j=[].slice;d.shadowCopy(d,{caches:{},vmodels:{},filters:{},components:{},directives:{},eventHooks:{},eventListeners:{},validators:{},scopes:{},cssHooks:e,parsers:{number:function(a){return""===a?"":parseFloat(a)||0},string:function(a){return null===a||void 0===a?"":a+""},"boolean":function(a){return""===a?a:"true"===a||"1"==a}},version:"2.114",slice:function(a,b,c){return j.call(a,b,c)},css:function(a,b,c,f){var g,h;if(a instanceof d&&(a=a[0]),1===a.nodeType){if(g=d.camelize(b),b=d.cssName(g)||g,void 0===c||"boolean"==typeof c)return f=e[g+":get"]||e["@:get"],"background"===b&&(b="backgroundColor"),h=f(a,b),c===!0?parseFloat(h)||0:h;if(""===c)a.style[b]="";else{if(null==c||c!==c)return;isFinite(c)&&!d.cssNumber[g]&&(c+="px"),f=e[g+":set"]||e["@:set"],f(a,b,c)}}},directive:function(a,b){return b.parse=b.parse||k,this.directives[a]=b},isObject:function(a){return null!==a&&"object"==typeof a},range:function(a,b,c){c||(c=1),null==b&&(b=a||0,a=0);for(var d=-1,e=Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a,a+=c;return f},hyphen:function(a){return a.replace(f,"$1-$2").toLowerCase()},camelize:function(a){return!a||a.indexOf("-")<0&&a.indexOf("_")<0?a:a.replace(g,function(a){return a.charAt(1).toUpperCase()})},makeHashCode:function(a){return a=a||"avalon",String(Math.random()+Math.random()).replace(h,a)},escapeRegExp:function(a){return(a+"").replace(i,"\\$&")},Array:{merge:function(a,b){a.push.apply(a,b)},ensure:function(a,b){return-1===a.indexOf(b)?a.push(b):void 0},removeAt:function(a,b){return!!a.splice(b,1).length},remove:function(a,b){var c=a.indexOf(b);return~c?d.Array.removeAt(a,c):!1}}}),"undefined"!=typeof performance&&performance.now&&(d.makeHashCode=function(a){return a=a||"avalon",(a+performance.now()).replace(".","")}),l=1,a.exports={avalon:d,getLongID:function(a){return a.uuid||(a.uuid=d.makeHashCode("e"))},getShortID:function(a){return a.uuid||(a.uuid="_"+ ++l)}}},function(a,b,c){function e(a){var b,c;for(b in a)d.ohasOwn.call(a,b)&&(c=a[b],"function"==typeof e.plugins[b]?e.plugins[b](c):e[b]=c);return this}var f,d=c(4);d.config=e,f={interpolate:function(a){var f,g,h,i,b=a[0],c=a[1];if(b===c)throw new SyntaxError("openTag!==closeTag");if(f=b+"test"+c,g=d.avalonDiv,g.innerHTML=f,g.innerHTML!==f&&g.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");g.innerHTML="",e.openTag=b,e.closeTag=c,h=d.escapeRegExp(b),i=d.escapeRegExp(c),e.rexpr=new RegExp(h+"([\\s\\S]*)"+i)}},e.plugins=f,d.config({interpolate:["{{","}}"],debug:!1}),a.exports=d},function(a,b,c){function l(a){return a}var d=c(4),e=c(9),f=c(10),g=c(11),h=c(12),i=c(13),j=d.filters,k=d.escapeHtml=c(14);d.__format__=function(a){var b=j[a];return b?b:l},d.mix(j,{uppercase:function(a){return String(a).toUpperCase()},lowercase:function(a){return String(a).toLowerCase()},truncate:function(a,b,c){return a?(a=String(a),isNaN(b)&&(b=30),c="string"==typeof c?c:"...",a.length>b?a.slice(0,b-c.length)+c:a):""},camelize:d.camelize,date:g,escape:k,sanitize:f,number:e,currency:function(a,b,c){return(b||"¥")+e(a,isFinite(c)?c:2)}},h,i),a.exports=d},function(a){function c(a,b,c,d){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var e=isFinite(+a)?+a:0,f=isFinite(+b)?Math.abs(b):3,g=d||",",h=c||".",i="",j=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};return i=(f?j(e,f):""+Math.round(e)).split("."),i[0].length>3&&(i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,g)),(i[1]||"").length<f&&(i[1]=i[1]||"",i[1]+=new Array(f-i[1].length+1).join("0")),i.join(h)}a.exports=c},function(a){var c=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,d=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,e=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,f={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi};a.exports=function(a){return a.replace(c,"").replace(e,function(a){var e,c=a.toLowerCase().match(/<(\w+)\s/);return c&&(e=f[c[1]],e&&(a=a.replace(e,function(a,b,c){var d=c.charAt(0);return b+"="+d+"javascript:void(0)"+d}))),a.replace(d," ").replace(/\s+/g," ")})}},function(a){function c(a){return parseInt(a,10)||0}function d(a,b,c){var d="";for(0>a&&(d="-",a=-a),a=""+a;a.length<b;)a="0"+a;return c&&(a=a.substr(a.length-b)),d+a}function e(a,b,c,e){return function(f){var g=f["get"+a]();return(c>0||g>-c)&&(g+=c),0===g&&-12===c&&(g=12),d(g,b,e)}}function f(a,b){return function(c,d){var e=c["get"+a](),f=(b?"SHORT"+a:a).toUpperCase();return d[f][e]}}function g(a){var b=-1*a.getTimezoneOffset(),c=b>=0?"+":"";return c+=d(Math[b>0?"floor":"ceil"](b/60),2)+d(Math.abs(b%60),2)}function i(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]}function m(a,b){var g,h,i,n,o,p,q,r,s,d=m.locate,e="",f=[];for(b=b||"mediumDate",b=d[b]||b,"string"==typeof a&&(/^\d+$/.test(a)?a=c(a):l.test(a)?a=+RegExp.$1:(i=a.trim(),n=[0,0,0,0,0,0,0],o=new Date(0),i=i.replace(/^(\d+)\D(\d+)\D(\d+)/,function(a,b,d,e){var f=4===e.length?[e,b,d]:[b,d,e];return n[0]=c(f[0]),n[1]=c(f[1])-1,n[2]=c(f[2]),""}),p=o.setFullYear,q=o.setHours,i=i.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(a,b,d,e,f){return n[3]=c(b),n[4]=c(d),n[5]=c(e),f&&(n[6]=Math.round(1e3*parseFloat("0."+f))),""}),r=0,s=0,i=i.replace(/Z|([+-])(\d\d):?(\d\d)/,function(a,b,d,e){return p=o.setUTCFullYear,q=o.setUTCHours,b&&(r=c(b+d),s=c(b+e)),""}),n[3]-=r,n[4]-=s,p.apply(o,n.slice(0,3)),q.apply(o,n.slice(3)),a=o)),"number"==typeof a&&(a=new Date(a));b;)h=k.exec(b),h?(f=f.concat(h.slice(1)),b=f.pop()):(f.push(b),b=null);return f.forEach(function(b){g=j[b],e+=g?g(a,d):b.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),e}var j,k,l,n;Object.prototype.toString,j={yyyy:e("FullYear",4),yy:e("FullYear",2,0,!0),y:e("FullYear",1),MMMM:f("Month"),MMM:f("Month",!0),MM:e("Month",2,1),M:e("Month",1,1),dd:e("Date",2),d:e("Date",1),HH:e("Hours",2),H:e("Hours",1),hh:e("Hours",2,-12),h:e("Hours",1,-12),mm:e("Minutes",2),m:e("Minutes",1),ss:e("Seconds",2),s:e("Seconds",1),sss:e("Milliseconds",3),EEEE:f("Day"),EEE:f("Day",!0),a:i,Z:g},k=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,l=/^\/Date\((\d+)\)\/$/,n={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"},n.SHORTMONTH=n.MONTH,m.locate=n,a.exports=m},function(a,b,c){function e(a,b,c){var f,g,h,k,e=d.type(a);if("array"!==e&&"object"!==e)throw"orderBy只能处理对象或数组";return f=c&&0>c?-1:1,"string"==typeof b&&(g=b,b=function(a){return a&&a[g]}),a=j(a),a.forEach(function(a){a.order=b(a.value,a.key)}),a.sort(function(a,b){var c=a.order,d=b.order;return Number.isNaN(c)&&Number.isNaN(d)?0:c===d?0:c>d?f:-f}),h="array"===e,k=h?[]:{},i(k,a,function(a){h?k.push(a.value):k[a.key]=a.value})}function f(a,b){var e,f,g,h,k,l,c=d.type(a);if("array"!==c&&"object"!==c)throw"filterBy只能处理对象或数组";if(e=d.slice(arguments,2),f=d.type(b),"function"===f)g=b;else{if("string"!==f&&"number"!==f)return a;if(""===b)return a;h=new RegExp(d.escapeRegExp(b),"i"),g=function(a){return h.test(a)}}return a=j(a).filter(function(a,b){return!!g.apply(a,[a.value,b].concat(e))}),k="array"===c,l=k?[]:{},i(l,a,function(a){k?l.push(a.value):l[a.key]=a.value})}function g(a,b,c){if(d.isObject(a)&&!Array.isArray(a)){var e=[];return i(e,b,function(b){e.push(a.hasOwnProperty(b)?a[b]:c?c[b]:"")})}return a}function h(a,b,c){var f,g,h,k,l,e=d.type(a);if("array"!==e&&"object"!==e)throw"limitBy只能处理对象或数组";if("number"!=typeof b)return a;if(Number.isNaN(b))return a;for("object"===e&&(a=j(a)),f=a.length,b=Math.floor(Math.min(f,b)),c="number"==typeof c?c:0,0>c&&(c=Math.max(0,f+c)),g=[],h=c;f>h&&g.length!==b;h++)g.push(a[h]);return(k="array"===e)?g:(l={},i(l,g,function(a){l[a.key]=a.value}))}function i(a,b,c){for(var d=0,e=b.length;e>d;d++)c(b[d]);return a}function j(a){var b=[],c=0;return d.each(a,function(a,d){b[c++]={value:d,key:a}}),b}var d=c(4);Number.isNaN=Number.isNaN||function(a){return a!==a},a.exports={limitBy:h,orderBy:e,selectBy:g,filterBy:f}},function(a){var e,c={stop:function(a){return a.stopPropagation(),a},prevent:function(a){return a.preventDefault(),a}},d={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};for(e in d)!function(a,b){c[a]=function(a){return a.which!==b&&(a.$return=!0),a}}(e,d[e]);a.exports=c},function(a){function c(a){return null==a?"":String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}a.exports=c},,function(a,b,c){function f(a){this.nodeName="#text",this.nodeValue=a,this.skipContent=!d.test(a)}var d=avalon.config.rexpr,e=c(17);f.prototype={constructor:f,toDOM:function(){if(this.dom)return this.dom;var a=e(this.nodeValue);return this.dom=document.createTextNode(a)},toHTML:function(){return this.nodeValue}},a.exports=f},function(a){var c=/&[a-z0-9#]{2,10};/,d=avalon.avalonDiv;a.exports=function(a){return c.test(a)?(d.innerHTML=a,d.innerText||d.textContent):a}},function(a){function c(a){this.nodeName="#comment",this.nodeValue=a}c.prototype={constructor:c,toDOM:function(){return this.dom=document.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"}},a.exports=c},,function(a){function c(a){this.nodeName="#document-fragment",this.children=a}c.prototype={constructor:c,toDOM:function(){var a,c,b;if(this.dom)return this.dom;for(a=document.createDocumentFragment(),b=0;c=this.children[b++];)a.appendChild(avalon.vdom(c,"toDOM"));return this.split=a.lastChild,this.dom=a},toHTML:function(){return this.children.map(function(a){return avalon.vdom(a,"toHTML")}).join("")}},a.exports=c},,,,,,function(a){var e,c={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},d=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(",");d.replace(/\w+/g,function(a){c[a.toLowerCase()]=a}),e=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(","),e.replace(/\w+/g,function(a){c[a.toLowerCase()]=a}),a.exports=c},,,,function(a,b,c){var d=c(31),e=c(4),f=/<|&#?\w+;/,g=new d(128),h=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;e.parseHTML=function(a){var c,d,j,i,b=e.avalonFragment.cloneNode(!1);if("string"!=typeof a)return b;if(!f.test(a))return document.createTextNode(a);if(a=a.replace(h,"<$1></$2>").trim(),c=g.get(a))return e.cloneNode(c);for(d=e.lexer(a),i=0;j=d[i++];)b.appendChild(e.vdom(j,"toDOM"));return a.length<1024&&g.put(a,b),b},e.innerHTML=function(a,b){var c=this.parseHTML(b);this.clearHTML(a).appendChild(c)},e.unescapeHTML=function(a){return String(a).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},e.clearHTML=function(a){for(a.textContent="";a.lastChild;)a.removeChild(a.lastChild);return a}},function(a){function c(a){this.size=0,this.limit=a,this.head=this.tail=void 0,this._keymap={}}var d=c.prototype;d.put=function(a,b){var c={key:a,value:b};return this._keymap[a]=c,this.tail?(this.tail.newer=c,c.older=this.tail):this.head=c,this.tail=c,this.size===this.limit?this.shift():this.size++,b},d.shift=function(){var a=this.head;a&&(this.head=this.head.newer,this.head.older=a.newer=a.older=this._keymap[a.key]=void 0,delete this._keymap[a.key],this.size--)},d.get=function(a){var b=this._keymap[a];if(void 0!==b)return b===this.tail?b.value:(b.newer&&(b===this.head&&(this.head=b.newer),b.newer.older=b.older),b.older&&(b.older.newer=b.newer),b.newer=void 0,b.older=this.tail,this.tail&&(this.tail.newer=b),this.tail=b,b.value)},a.exports=c},,function(a){a.exports={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0}},,function(a,b,c){function f(a){var c,b,h,i,j,k,l,m,n,o,p,q;for(b=0;c=a[b++];)if(1===c.nodeType)if(h=g(c),i=avalon.vmodels[h],i&&!i.$element){if(i.$element=c,avalon.serverTemplates&&avalon.serverTemplates[h]){j=avalon.serverTemplates[h],k=avalon.speedUp(avalon.lexer(j)),l=avalon.render(k),m=l(i),n=avalon.vdom(m[0],"toDOM"),i.$element=n,n.vtree=m,i.$render=l,c.parentNode.replaceChild(n,c),avalon.diff(m,m);continue}m=[e(c)],o=new Date,c.vtree=avalon.speedUp(m),p=new Date,d&&avalon.log("构建虚拟DOM耗时",p-o,"ms"),i.$render=avalon.render(c.vtree),avalon.scopes[i.$id]={vmodel:i,local:{},isTemp:!0},q=new Date,d&&avalon.log("构建当前vm的$render方法耗时 ",q-p,"ms\n","如果此时间太长,达100ms以上\n","建议将当前ms-controller拆分成多个ms-controller,减少每个vm管辖的区域"),avalon.rerenderStart=q,d=!1,avalon.batch(h)}else h||f(c.childNodes)}function g(a){return a.getAttribute("ms-controller")||a.getAttribute(":controller")}var d=!0,e=c(36);a.exports=avalon.scan=function(a){return a&&a.nodeType?(f([a]),void 0):(avalon.warn("[avalon.scan] first argument must be element , documentFragment, or document"),void 0)},avalon.scan.dom2vdom=e},function(a,b,c){function h(a){var d,e,h,j,k,b=a.attributes,c={};for(d=0,e=b.length;e>d;d++)h=b[d],h.specified&&(j=h.name,":"===j.charAt(0)&&(j=j.replace(g,"ms-")),c[j]=h.value);return f.test(a.nodeName)&&(c.type=a.type),k=a.style.cssText,k&&(c.style=k),"select-one"===c.type&&(c.selectedIndex=a.selectedIndex),i(c)?null:c}function i(a){for(var b in a)return!1;return!0}function j(a){var e,f,b={},c=a.nodeName.toLowerCase();return b.nodeName=c,b.dom=a,"#"===c.charAt(0)?(e=a.nodeValue,/\S/.test(e)&&(b.nodeValue=e)):(f=h(a),d[c]&&(b.isVoidTag=!0),b.children=k(a),"selectedIndex"in b&&(a.selectedIndex=b.selectedIndex,delete b.selectedIndex),f&&(b.props=f)),b}function k(a){var d,e,f,g,b=[],c=a.firstChild;if(!c)return b;do{switch(d=c.nextSibling,c.nodeType){case 1:e=c.getAttributeNode(":for")||c.getAttributeNode("ms-for"),e?(f=document.createComment("ms-for:"+e.value),g=document.createComment("ms-for-end:"),c.removeAttributeNode(e),a&&(a.insertBefore(g,c.nextSibling),a.insertBefore(f,c)),b.push(j(f),j(c),j(g))):b.push(j(c));break;case 3:/\S/.test(c.nodeValue)?b.push(j(c)):m(c);break;case 8:b.push(j(c))}c=d}while(c);return b}function m(a){return l.appendChild(a),l.removeChild(a),a}var f,g,l,d=c(37);c(38),f=/input|textarea|select/i,g=/^\:/,l=avalon.avalonFragment,a.exports=j},function(a){a.exports=avalon.oneObject("area,base,basefont,bgsound,br,col,command,embed,frame,hr,img,input,keygen,link,meta,param,source,track,wbr")},function(a,b,c){function m(a,b){var e,d,f,g,c=b?[]:["\nvar vnodes = [];"];for(d=0;e=a[d++];)f=n(e),e.$prepend&&c.push(e.$prepend),g=e.$append,delete e.$append,delete e.$prepend,f&&c.push(f+"\n"),g&&c.push(g);return b||c.push("return vnodes\n"),c.join("\n")}function n(a){var b,c,g,h,i,j,n,o,s;if(!a.nodeName)return!1;switch(a.nodeName){case"#text":return a.dynamic?p(r(a)):q(a);case"#comment":if(b=a.nodeValue,a.forExpr){c={dynamic:!0,vmodel:"__vmodel__"};for(g in a)a.hasOwnProperty(g)&&!l[g]&&(c[g]=a[g]);return avalon.directives["for"].parse(c,a,a),a.$append+=avalon.caches[a.signature],q(c)}return"ms-for-end:"===b?(a.$append=q({nodeName:"#comment",nodeValue:a.signature})+" return vnodes}\n })\n},__local__,vnodes)\n"+q({nodeName:"#comment",signature:a.signature,nodeValue:"ms-for-end:"})+"\n",""):0===b.indexOf("ms-js:")?(h=f(b.replace("ms-js:",""),"js")+"\n",i=q(a),j=h.match(k),j&&j[1]?a.$append=(a.$append||"")+h+"\n__local__."+j[1]+" = "+j[1]+"\n":avalon.warn(b+" parse fail!"),i):q(a);default:if(!a.dynamic&&a.skipContent)return q(a);if(c={nodeName:a.nodeName},n=a.props,a.dynamic)c.dynamic="{}",o=d(c,n),o.map(function(b){return avalon.directives[b.type].parse(c,a,b),b.name});else if(n){c.props={};for(g in n)c.props[g]=n[g]}return a.isVoidTag?c.isVoidTag=!0:"children"in c||(s=a.children,s&&(c.children=a.skipContent?"["+s.map(function(a){return e(a)})+"]":1===s.length&&"#text"===s[0].nodeName?s[0].dynamic?"["+r(s[0])+"]":"["+e(s[0])+"]":"(function(){"+m(s)+"})()")),a.template&&(c.template=a.template),a.skipContent&&(c.skipContent=!0),q(c)}}function o(a){return j.test(a)?a:f(a,"text")}function p(a){return"vnodes.push("+a+");"}function q(a){return p(e(a))}function r(a){var d,b=t(a.nodeValue),c="";return 1===b.length?c=o(b[0].expr):(d=b.map(function(a){return a.type?o(a.expr):i(a.expr)}).join(" + "),c="String("+d+")"),'{\nnodeName: "#text",\ndynamic:true,\nnodeValue: '+c+"\n}"}function t(a){var c,d,b=[];do c=a.indexOf(h.openTag),c=-1===c?a.length:c,d=a.slice(0,c),/\S/.test(d)&&b.push({expr:g(d)}),a=a.slice(c+h.openTag.length),a&&(c=a.indexOf(h.closeTag),d=a.slice(0,c),b.push({expr:avalon.unescapeHTML(d.replace(s,"")),type:"{{}}"}),a=a.slice(c+h.closeTag.length));while(a.length);return b}var s,d=c(39),e=c(40),f=c(41),g=c(17),h=avalon.config,i=avalon.quote,j=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,k=/^\s*var\s+([$\w]+)\s*\=\s*\S+/,l={__local__:1,vmode:1,dom:1};a.exports=m,s=/\n\s*/g},function(a){function f(a,b){var k,m,l,n,o,p,f=[],h={},i="ms-skip"in b,j={};for(k in b)if(l=b[k],h[k]=b[k],m=k.match(d)){if(i)continue;n=k.replace(m[1],"").split("-"),e[n[0]]&&n.unshift("on"),"on"===n[0]&&(n[2]=parseFloat(n[2])||0),n.unshift("ms"),o=n[1],c[o]&&(p={type:o,param:n[2],name:n.join("-"),expr:l,priority:c[o].priority||100*o.charCodeAt(0)},"on"===o&&(p.priority+=n[3]),j[p.name]||(j[p.name]=l,f.push(p)))}return a.props=h,f.sort(g),f}function g(a,b){return a.priority-b.priority}var c=avalon.directives,d=/^(\:|ms\-)\w+/,e=avalon.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit");a.exports=f},function(a){function g(a){return e.test(a)||c[a]?f(a):a}function h(a){var c,e,i,j,k,l,b=[];for(c in a)if(e=typeof a[c],"object"===e)if("props"===c){i=[];for(j in a.props)k=a.props[j],"string"==typeof k&&(k=f(k)),i.push(g(j)+": "+k);b.push(c+": {"+i.join(",\n")+"}")}else"children"===c&&b.push("children: ["+a[c].map(function(a){return h(a)})+"]");else a.hasOwnProperty(c)&&(l=a[c],"string"===e&&(l=d[c]?f(l):l),b.push(g(c)+":"+l));return"{\n"+b.join(",\n")+"}"}var d,e,f,c=avalon.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile");avalon.keyMap=c,d={nodeName:1,template:1,forExpr:1,type:1,nodeValue:1,signature:1,wid:1},e=/[W\:-]/,f=avalon.quote,a.exports=h},function(a,b,c){function p(a,b){var c=a.replace(n,"").match(o);c&&c.filter(function(a){/^[@\d\-]/.test(a)||"##"===a.slice(0,2)||"$event"===a||avalon.keyMap[a]||(b[a]=1)})}function q(a){var c,b=[];for(c in a)b.push("var "+c+" = __local__["+avalon.quote(c)+"]");return b}function r(a,b){function u(a){var b="??"+r++;return t[b]=a,b}function v(a){return t[a]}var n,o,r,t,w,x,y,z,A,B,C,D,c={};if(b=b||"other","object"==typeof a&&(b=a.type,c=a,a=c.expr),n=a,o=d.get(b+":"+n))return o;if(r=1,t={},w=a.replace(e,u).replace(f,u).replace(i,u).replace(k,"$1").split(j),x=w.shift(),y={},z=x.replace(g,v).trim(),"on"===b&&m.test(z)&&(z+="($event)"),z=z.replace(l,"$1__vmodel__."),"on"===b)p(x,y);else if("js"===b)return d.put(b+":"+n,z);if(A=w.map(function(a){p(a.replace(/^\w+/g,""),y),a=a.replace(g,v).replace(l,"$1__vmodel__.");var b=!1;return a=a.replace(h,function(a,c){return b=!0,/\S/.test(c)?"(__value__,"+c+");":"(__value__);"}),b||(a+="(__value__);"),a=a.replace(/(\w+)/,'avalon.__format__("$1")'),"__value__ = "+a}),B=[],"on"===b)A=A.map(function(a){return a.replace(/__value__/g,"$event")}),A.length&&A.push("if($event.$return){\n	return;\n}"),avalon.modern||(z=z.replace(/__vmodel__\.([^(]+)\(([^)]*)\)/,function(a,b,c){return"__vmodel__."+b+".call(__vmodel__"+(/\S/.test(c)?","+c:"")+")"})),B=["function ($event, __local__){","try{",q(y).join("\n"),"	var __vmodel__ = this;","	"+z,"}catch(e){",s(a,b),"}","}"],A.unshift(2,0);else{if("duplex"===b)return C=["function (__vmodel__,__value__){","try{","	"+z+" = __value__","}catch(e){",s(a,b).replace("parse","set"),"}","}"],d.put("duplex:set:"+n,C.join("\n")),D=["function (__vmodel__){","try{","var __value__ = "+z+"\n",A.join("\n"),"return __value__\n","}catch(e){",s(a,b).replace("parse","get"),"}","}"].join("\n"),d.put("duplex:get:"+n,D),D;B=["(function(){","try{","var __value__ = "+z,"text"===b?"return avalon.parsers.string(__value__)":"return __value__","}catch(e){",s(a,b),'	return ""',"}","})()"],A.unshift(3,0)}return B.splice.apply(B,A),o=B.join("\n"),d.put(b+":"+n,o),o}function s(a,b){return"	avalon.warn(e, "+avalon.quote("parse "+b+" binding【 "+a+" 】fail")+")"}var d=c(42),e=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g,f=/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/g,g=/\?\?\d+/g,h=/\(([^)]*)\)/,i=/\|\|/g,j=/\|(?=\w)/,k=/\s*(\.|\|)\s*/g,l=/(^|[^\w\u00c0-\uFFFF_])(@|##)(?=[$\w])/g,m=/^(?:\@|##)[$\w\.]+$/i,n=/\|.+/g,o=/((?:\@|\$|\#\#)?\w+)/g;a.exports=avalon.parseExpr=r},function(a,b,c){var d=c(31);a.exports=new d(888)},,function(a,b,c){var d=c(45);avalon.directive("important",{priority:1,parse:function(a,b,c){var e,d=avalon.quote(c.expr);a.local="{}",a.vmodel="__vmodel__",a[c.name]=1,e="(function(){ return __vmodel__ = avalon.vmodels["+d+"]})()",b.$prepend=["(function(__vmodel__){","var __i = avalon.scopes["+d+"]","var ok = !__i || __i.vmodel === __vmodel__",'if( !ok ){avalon.log("不进入"+'+d+");return }"].join("\n")+"\n"+e,b.$append="\n})(__vmodel__);"},diff:function(a,b,c){b.dynamic[c]||(b.local=a.local,b.vmodel=a.vmodel,d(b,this.update))},update:function(a,b,c){avalon.directives.controller.update(a,b,c,"important")}})},function(a){a.exports=function(a,b,c){if(c)a.afterChange=a.afterChange||[],avalon.Array.ensure(a.afterChange,b);else{var d=a.dom;b(a.dom,a,d&&d.parentNode)}}},function(a,b,c){var d=c(45),e={};avalon.mediatorFactoryCache=function(a,b){var g,c=a.$hashcode,d=b.$hashcode,f=c+d;return e[f]?e[f]:(g=avalon.mediatorFactory(a,b),e[f]=g)},avalon.directive("controller",{priority:2,parse:function(a,b,c){var e,d=avalon.quote(c.expr);a.local="__local__",a.vmodel="__vmodel__",a[c.name]=1,e=["(function(){","var vm = avalon.vmodels["+d+"]","if(vm && __vmodel__&& vm !== __vmodel__){","return __vmodel__ = avalon.mediatorFactoryCache(__vmodel__, vm)","}else if(vm){","return __vmodel__ = vm","}","})();"].join("\n"),b.$prepend="(function(__vmodel__){"+e,b.$append="\n})(__vmodel__);"},diff:function(a,b,c){b.dynamic[c]||(b.local=a.local,b.vmodel=a.vmodel,d(b,this.update))},update:function(a,b,c,e){var i,j,k,l,m,f=b.vmodel,g=b.local,h=e?"ms-important":"ms-controller";b.dynamic[h]=1,i=b.props[h],j=avalon.scopes[i],j||(k=avalon.vmodels[i],l=f.$element&&f.$element.vtree[0]===b?f.$render:avalon.render([b],g),f.$render=l,f.$element=a,a.vtree=[b],k!==f&&(k.$render=k.$render||l,k.$element=k.$element||a),m=e?f:k,j=avalon.scopes[i]={vmodel:f,local:g},d(b,function(){avalon(a).removeClass("ms-controller");var b=m.$events["onReady"];b&&(m.$fire("onReady"),delete m.$events.onReady),j.isMount=!0},"afterChange"))}})},,function(a,b,c){var d=c(45);avalon.directive("css",{diff:function(a,b,c){var g,h,i,j,e=a[c],f=b[c];if(Object(e)===e){if(e=e.$model||e,Array.isArray(e)&&(g={},e.forEach(function(a){a&&avalon.shadowCopy(g,a)}),e=g),h=!1,b.dynamic[c]&&f){i={};for(j in e)e[j]!==f[j]&&(h=!0),i[j]=e[j];for(j in f)j in i||(h=!0,i[j]="");b[c]=i}else b[c]=e,h=!0;h&&d(b,this.update)}delete a[c]},update:function(a,b){var c,d,e;if(a&&1===a.nodeType){c=avalon(a),b.dynamic["ms-css"]=1,d=b["ms-css"];for(e in d)c.css(e,d[e])}}})},function(a,b,c){function f(a,b){var h,c=a.ownerDocument,d=a.nodeName,g="_"+d;return f[g]||(h=c.body.appendChild(c.createElement(d)),b=avalon.css(h,"display"),c.body.removeChild(h),b===e&&(b="block"),f[g]=b),f[g]}var d=c(45),e="none";avalon.parseDisplay=f,avalon.directive("visible",{diff:function(a,b,c){var e=!!a[c];b.dynamic[c]&&e===b[c]||(b[c]=e,d(b,this.update))},update:function(a,b){function h(){void 0!==g&&(a.style.display=g)}var c,d,g;a&&1===a.nodeType&&(b.dynamic["ms-visible"]=1,c=b["ms-visible"],d=a.style.display,c?(d===e&&(g=b.displayValue,g||(a.style.display="")),""===a.style.display&&avalon(a).css("display")===e&&avalon.contains(a.ownerDocument,a)&&(g=f(a))):d!==e&&(g=e,b.displayValue=d),avalon.applyEffect(a,b,{hook:c?"onEnterDone":"onLeaveDone",cb:h}))}})},function(a,b,c){c(45),avalon.directive("expr",{parse:avalon.noop})},function(a,b,c){var d=c(45);avalon.directive("text",{parse:function(a,b,c){a[c.name]=1,b.children=[],a.children='[{\nnodeName:"#text",\ndynamic:true,\nnodeValue:avalon.parsers.string('+avalon.parseExpr(c)+")}]"},diff:function(a,b){b.children.length||d(b,this.update)},update:function(a,b){var c,d;if(a&&!b.isVoidTag){for(c=a;c.firstChild;)c.removeChild(c.firstChild);a=document.createTextNode("x"),c.appendChild(a),d={nodeType:3,nodeName:"#text",dom:a},b.children.push(d)}}})},function(a,b,c){var d=c(45);avalon.directive("html",{parse:function(a,b,c){b.isVoidTag?a.children="[]":(a[c.name]=avalon.parseExpr(c),a.vmodel="__vmodel__",a.local="__local__")},diff:function(a,b,c){var f,g,h,e=a[c]+"";b.dynamic["ms-html"]&&b.render&&e===b[c]?b.render&&(h=b.render(a.vmodel,a.local),a.children=h):(b[c]=e,f=avalon.speedUp(avalon.lexer(e)),g=avalon.render(f,a.local),b.render=g,h=g(a.vmodel,a.local),b.children=a.children=h,d(b,this.update))},update:function(a,b){b.dynamic["ms-html"]=1,avalon.clearHTML(a),a.appendChild(avalon.domize(b.children))}})},function(a,b,c){function f(){var b,c,d,e,a=[];for(b=0;b<arguments.length;b++)if(c=arguments[b],d=typeof c,"string"===d||"number"===d||c===!0)a.push(c);else if(Array.isArray(c))a.push(f.apply(null,c));else if("object"===d)for(e in c)c.hasOwnProperty(e)&&c[e]&&a.push(e);return a.join(" ")}function i(a){var b=a.target;avalon(b).addClass(b.getAttribute(h[a.type])||"")}function j(a){var b=a.target,c=h[a.type];avalon(b).removeClass(b.getAttribute(c)||""),"change-active"!==c&&avalon(b).removeClass(b.getAttribute("change-active")||"")}function k(a,b){var c=a.getAttribute("old-change-class"),d=b["ms-class"];c!==d&&(avalon(a).removeClass(c).addClass(d),a.setAttribute("old-change-class",d))}var h,d=c(6).getLongID,e=c(45),g=avalon.directives;avalon.directive("class",{diff:function(a,b,c){var l,d=c.slice(3),g=a[c],h=b[c]||"",k=b.classEvent||{};"hover"===d?(k.mouseenter=i,k.mouseleave=j):"active"===d&&(b.props.tabindex=a.props.tabindex||-1,k.tabIndex=b.props.tabindex,k.mousedown=i,k.mouseup=j,k.mouseleave=j),b.classEvent=k,l=f(g),b.dynamic[c]&&h===l||(b[c]=l,b["change-"+d]=l,e(b,this.update,d))},update:function(a,b){var c,d,e;if(a&&1===a.nodeType){if(c=b.classEvent){for(d in c)"tabIndex"===d?a[d]=c[d]:avalon.bind(a,d,c[d]);b.classEvent={}}e=["class","hover","active"],e.forEach(function(c){var f,d="change-"+c,e=b[d];void 0!==e&&(b.dynamic["ms-"+c]=1,"class"===c?a&&k(a,b):(f=a.getAttribute("change-"+c),f&&avalon(a).removeClass(f),a.setAttribute(d,e)))})}}}),g.active=g.hover=g["class"],h={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"},d(i),d(j)},function(a,b,c){function l(a,b){for(var c in a)if(a[c]!==b[c])return!0;return!1}var f,k,d=c(31);new d(128),f=c(45),c(6).getLongID,k=/^ms\-on\-(\w+)/,avalon.directive("on",{priority:3e3,parse:function(a,b,c){var d=c.name.replace("ms-on-","e").replace("-","_"),e=d+"_"+c.expr.replace(/\s/g,"").replace(/[^$a-z]/gi,function(a){return a.charCodeAt(0)}),f=avalon.quote(e),g="(function(){\nvar fn610 = "+avalon.parseExpr(c,"on")+"\nfn610.uuid ="+f+";\nreturn fn610})()";a.vmodel="__vmodel__",a.local="__local__",a[c.name]=g},diff:function(a,b,c){var d=a[c],e=d.uuid,g=b[c]||{},h=!1;b.dynamic[c]&&g.uuid===e||(b[c]=d,avalon.eventListeners[e]=d,h=!0),l(b.local||{},a.local)&&(h=!0),h&&(b.local=a.local,b.vmodel=a.vmodel,f(b,this.update))},update:function(a,b){var c,d,e;if(a&&1===a.nodeType){a._ms_context_=b.vmodel,a._ms_local=b.local;for(c in b)e=c.match(k),e&&(d=b[c],b.dynamic[c]=1,avalon.bind(a,e[1],d))}}})},,,function(a,b,c){function e(){var e,g,h,b=this,c=this.__ms_duplex__;if(!b.composing&&b.value!==c.value){if(b.caret)try{e=c.getCaret(b),c.pos=e}catch(f){avalon.warn("fixCaret error",f)}c.debounceTime>4?(g=new Date,h=g-c.time||0,c.time=g,h>=c.debounceTime?d[c.type].call(c):(clearTimeout(c.debounceID),c.debounceID=setTimeout(function(){d[c.type].call(c)},h))):d[c.type].call(c)}}var d=c(58);a.exports=e},function(a){function d(a){a.callback&&a.callback.call(a.vmodel,{type:"changed",target:a.dom})}var c={input:function(a){var c,e,f,g,b=this;a=a||"value",c=b.dom,e=c[a],f=b.parse(e),b.value=e,b.set(b.vmodel,f),d(b),g=b.pos,c.caret&&b.setCaret(c,g)},radio:function(){var b,a=this;a.isChecked?(b=!a.value,a.set(a.vmodel,b),d(a)):(c.input.call(a),a.value=0/0)},checkbox:function(){var c,e,a=this,b=a.value;Array.isArray(b)||(avalon.warn("ms-duplex应用于checkbox上要对应一个数组"),b=[b]),c=a.dom.checked?"ensure":"remove",b[c]&&(e=a.parse(a.dom.value),b[c](e),d(a))},select:function(){var a=this,b=avalon(a.dom).val();b+""!=this.value+""&&(b=Array.isArray(b)?b.map(function(b){return a.parse(b)}):a.parse(b),a.set(a.vmodel,b),d(a))},contenteditable:function(){c.input.call(this,"innerHTML")}};a.exports=c},function(a){function g(a){d[this.tagName].call(this,a);var b=this.__ms_duplex__;!this.caret&&b&&b.isString&&b.update.call(this,{type:"setter"})}var d,e,f,h,c=!1;try{d={},e=HTMLInputElement.prototype,f=HTMLTextAreaElement.prototype,h=HTMLInputElement.prototype,Object.getOwnPropertyNames(h),d["INPUT"]=Object.getOwnPropertyDescriptor(e,"value").set,Object.defineProperty(e,"value",{set:g}),d["TEXTAREA"]=Object.getOwnPropertyDescriptor(f,"value").set,Object.defineProperty(f,"value",{set:g}),c=!0
}catch(i){}a.exports=c},,function(a){a.exports=function(a,b){var e,c=a.__ms_duplex__,d=b["ms-rules"];if(d&&!c.validator)for(;a&&1===a.nodeType;){if(e=a._ms_validator_){c.rules=d,c.validator=e,avalon.Array.ensure(e.fields,c)&&e.addField(c);break}a=a.parentNode}}},function(a,b,c){function g(){var a=this.data||{};return this.message.replace(f,function(b,c){return null==a[c]?"":a[c]})}var d=c(45),e=avalon.directive("validate",{diff:function(a,b,c){var f=a[c],g=b[c];if(!(g&&g.onError&&g.addField)&&Object(f)===f){b.vmValidator=f,f.$id&&(f=f.$model),b[c]=f;for(c in e.defaults)f.hasOwnProperty(c)||(f[c]=e.defaults[c]);f.fields=f.fields||[],d(b,this.update)}},update:function(a,b){function g(){e.validateAll.call(c,c.onValidateAll)}var d,c=b["ms-validate"];a._ms_validator_=c,c.dom=a,d=b.vmValidator;try{d.onManual=g}catch(f){}delete b.vmValidator,a.setAttribute("novalidate","novalidate"),c.validateAllInSubmit&&avalon.bind(a,"submit",function(a){a.preventDefault(),g()}),"function"==typeof c.onInit&&c.onInit.call(a,{type:"init",target:a,validator:c})},validateAll:function(a){var b=this,c="function"==typeof a?a:b.onValidateAll,d=b.fields.filter(function(a){var c=a.dom;return c&&!c.disabled&&b.dom.contains(c)}).map(function(a){return e.validate(a,!0)}),f=[];Promise.all(d).then(function(a){var e,d,g;for(d=0;e=a[d++];)f=f.concat(e);b.deduplicateInValidateAll&&(g={},f=f.filter(function(a){var b=a.dom,c=b.uniqueID||(b.uniqueID=setTimeout("1"));return g[c]?!1:(g[c]=!0,!0)})),c.call(b.dom,f)})},addField:function(a){var b=this,c=a.dom;!b.validateInKeyup||a.isChanged||a.debounceTime||avalon.bind(c,"keyup",function(b){e.validate(a,0,b)}),b.validateInBlur&&avalon.bind(c,"blur",function(b){e.validate(a,0,b)}),b.resetInFocus&&avalon.bind(c,"focus",function(d){b.onReset.call(c,d,a)})},validate:function(a,b,c){var i,j,k,l,m,n,o,p,d=[],e=a.value,f=a.dom,h=a.validator;if(!f.disabled){for(i in a.rules)j=a.rules[i],j!==!1&&(k=avalon.validators[i],d.push(new Promise(function(a,b){l=a,m=b})),n=function(b){if(a.norequired&&""===e&&(b=!0),b)l(!0);else{var c={element:f,data:a.data,message:f.getAttribute("data-"+i+"-message")||f.getAttribute("data-message")||k.message,validateRule:i,getMessage:g};l(c)}},a.data={},a.data[i]=j,k.get(e,a,n));return o=[],p=Promise.all(d).then(function(a){for(var e,d=0;e=a[d++];)"object"==typeof e&&o.push(e);return b||(o.length?h.onError.call(f,o,c):h.onSuccess.call(f,o,c),h.onComplete.call(f,o,c)),o})}}}),f=/\\?{{([^{}]+)\}}/gm;e.defaults={addField:e.addField,onError:avalon.noop,onSuccess:avalon.noop,onComplete:avalon.noop,onManual:avalon.noop,onReset:avalon.noop,onValidateAll:avalon.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1}},function(){function c(a){return"regexp"===avalon.type(a)}function f(a){var b,c,d,e,f;return"string"==typeof a&&a&&(b=a.split("-"),3===b.length&&4===b[0].length)?(c=~~b[0],d=~~b[1]-1,e=~~b[2],f=new Date(c,d,e),f.getFullYear()===c&&f.getMonth()===d&&f.getDate()===e):!1}var d,e;avalon.directive("rules",{diff:function(a,b,c){var e,d=a[c];d&&"[object Object]"===Object.prototype.toString.call(d)&&(b[c]=d.$model||d,e=b.dom&&b.dom.__ms_duplex__,e&&(e.rules=a[c]))}}),d=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,e=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,avalon.shadowCopy(avalon.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(a,b,d){var g,e=b.dom,f=b.data;return c(f.pattern)||(g=e.getAttribute("pattern"),f.pattern=new RegExp("^(?:"+g+")$")),d(f.pattern.test(a)),a}},digits:{message:"必须整数",get:function(a,b,c){return c(/^\-?\d+$/.test(a)),a}},number:{message:"必须数字",get:function(a,b,c){return c(isFinite(a)),a}},required:{message:"必须填写",get:function(a,b,c){return c(""!==a),a}},equalto:{message:"密码输入不一致",get:function(a,b,c){var d=String(b.data.equalto),e=avalon(document.getElementById(d)).val()||"";return c(a===e),a}},date:{message:"日期格式不正确",get:function(a,b,d){var e=b.data;return c(e.date)?d(e.date.test(a)):d(f(a)),a}},url:{message:"URL格式不正确",get:function(a,b,c){return c(e.test(a)),a}},email:{message:"email格式不正确",get:function(a,b,c){return c(d.test(a)),a}},minlength:{message:"最少输入{{minlength}}个字",get:function(a,b,c){var d=parseInt(b.data.minlength,10);return c(a.length>=d),a}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(a,b,c){var d=parseInt(b.data.maxlength,10);return c(a.length<=d),a}},min:{message:"输入值不能小于{{min}}",get:function(a,b,c){var d=parseInt(b.data.min,10);return c(parseFloat(a)>=d),a}},max:{message:"输入值不能大于{{max}}",get:function(a,b,c){var d=parseInt(b.data.max,10);return c(parseFloat(a)<=d),a}},chs:{message:"必须是中文字符",get:function(a,b,c){return c(/^[\u4e00-\u9fa5]+$/.test(a)),a}}})},function(a,b,c){var d=c(45);avalon.directive("if",{priority:6,diff:function(a,b,c){var h=!!a[c];b[c]=h,d(b,this.update)},update:function(a,b,c){var e,d=b["ms-if"];if(b.dynamic["ms-if"]&&(b.dynamic["ms-if"]=b.nodeName),d){if("#comment"===b.nodeName){if(b.nodeName=b.dynamic["ms-if"],delete b.nodeValue,e=b.comment,!e)return;c=e.parentNode,c&&c.replaceChild(a,e),delete b.comment,avalon.applyEffect(a,b,{hook:"onEnterDone"})}}else b.comment||(b.comment=document.createComment("if")),b.nodeName="#comment",b.nodeValue="if",avalon.applyEffect(a,b,{hook:"onLeaveDone",cb:function(){c=c||a.parentNode,c&&c.replaceChild(b.comment,a)}})}})},function(a,b,c){function i(a){var b=typeof a;return a&&"object"===b?a.$hashcode:b+":"+a}function j(a,b,c,d,e,f,g,h){var l,j=h?i(b):a,k={};k[e]=a,k[f]=b;for(l in c)l in k||(k[l]=c[l]);d(a,b,j,k,g)}function k(a,b){var c=a.children.map(function(a){return a["ms-if"]?a.comment:a.dom});return b&&c.forEach(function(b){a.dom.appendChild(b)}),c}function n(a){var b,c;for(c in a){b=c;break}return b?o(a,b):void 0}function o(a,b){var d,e,c=a[b];return c?(d=c.arr)?(e=d.pop(),d.length||(c.arr=0),e):(delete a[b],c):void 0}function p(a,b){var d,e,c=b.key;a[c]?(d=a[c],e=d.arr||(d.arr=[]),e.push(b)):a[c]=b}var q,d=c(45),e=/\s+as\s+([$\w]+)/,f=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,g=/^(null|undefined|NaN|window|this|\$index|\$id)$/,h=/[$\w]+/g;avalon._each=function(a,b,c,d){var f,g,e=[];if(d.push(e),f=(b+"").slice(0,40).match(h),f.shift(),Array.isArray(a))for(g=0;g<a.length;g++)j(g,a[g],c,b,f[0],f[1],e,!0);else for(g in a)a.hasOwnProperty(g)&&j(g,a[g],c,b,f[0],f[1],e)},avalon.directive("for",{priority:3,parse:function(a,b){var i,j,k,l,m,d=b.forExpr;d=d.replace(e,function(a,b){return!f.test(b)||g.test(b)?avalon.error("alias "+b+" is invalid --- must be a valid JS identifier which is not a reserved name."):i=b,""}),j=d.split(" in "),k="var loop = "+avalon.parseExpr(j[1])+" \n",l=i?"var "+i+" = loop\n":"",m=j[0].match(h),1===m.length&&m.unshift("$key"),m.push("traceKey","__local__","vnodes"),b.$append=k+l+"avalon._each(loop,function("+m.join(", ")+"){\n"+(i?"__local__["+avalon.quote(i)+"]=loop\n":"")+'vnodes.push({\nnodeName: "#document-fragment",\nindex: arguments[0],\nkey: traceKey,\n'+"children: new function(){\n var vnodes = []\n"},diff:function(a,b,c,e,f){var g,h,i,j,k,l,m,q,r,s,t,u,v;if(!avalon.callArray||!b.list||-1!==b.forExpr.indexOf(avalon.callArray)){if(g=e[f+1],h=c[f+1],i=e[f+2],j=b.cache||{},q=[],g.length)if(g===h)h.forEach(function(a){a.action="move",p(j,a)}),b.cache=j,r=!0;else{for(b.action="update",s={},t=[],k=0;l=h[k];k++)m=o(j,l.key),m?(m.oldIndex=m.index,m.index=l.index,p(s,m)):t.push(l);for(k=0;l=t[k];k++)m=n(j,l.key),m?(m.oldIndex=m.index,m.index=l.index,m.key=l.key):(m=l,g.push(m)),p(s,m);g.sort(function(a,b){return a.index-b.index}),b.cache=s;for(k in j)m=j[k],m.action="leave",avalon.Array.remove(g,m),q.push(m),m.arr&&(m.arr.forEach(function(a){a.action="leave",q.push(a)}),delete m.arr)}else b.action="init",e[f+1]=h,h.forEach(function(a,b){g[b]=a,p(j,a)}),b.cache=j;return q.length>1&&q.sort(function(a,b){return a.index-b.index}),b.removes=q,u=avalon.caches[b.wid],v=a.vmodel,i&&u&&(i.afterChange=[function(a){u.call(v,{type:"rendered",target:a,signature:b.signature})}]),r||(b.list=g,d(b,this.update)),!0}},update:function(a,b,c){var d,e,f,h,g;for("init"===b.action&&(d=c,c=document.createDocumentFragment()),e=a,f=b.signature,g=0;h=b.removes[g++];)h.dom&&(delete h.split,b.hasEffect?!function(a){var b=k(a),c=a.children.concat();a.children.length=0,q(b,c,{hook:"onLeaveDone",staggerKey:f+"leave",cb:function(a){a.parentNode&&a.parentNode.removeChild(a)}})}(h):k(h,"add"));b.list.forEach(function(a,d){var g,h;"leave"!==a.action&&(a.dom||(a.dom=avalon.domize(a)),g=a.dom,void 0===a.oldIndex?(b.hasEffect&&(h=avalon.slice(g.childNodes)),0===d&&"init"===b.action?c.appendChild(g):c.insertBefore(g,e.nextSibling),b.hasEffect&&q(h,a.children,{hook:"onEnterDone",staggerKey:f+"enter"})):a.index!==a.oldIndex&&(h=k(a,"add"),c.insertBefore(a.dom,e.nextSibling),b.hasEffect&&q(h,a.children,{hook:"onMoveDone",staggerKey:f+"move"})),e=a.split)}),"init"===b.action&&d.insertBefore(c,a.nextSibling)}}),avalon.domize=function(a){return avalon.vdom(a,"toDOM")},q=function(a,b,c){b.forEach(function(b,d){avalon.applyEffect(a[d],b,c)})}},function(a,b,c){function f(a,b){var c=b.props.is,d=b["component-vm:"+c],e="component-html:"+c,f=b[e],g=avalon.vdom(b,"toHTML");f!==g&&(b[e]=g,d.$fire("onViewChange",{type:"viewchange",target:a,vmodel:d,is:c}))}function g(a){var b=!0;try{h(a)}catch(c){b=!1}return b}function h(a){a.children.forEach(function(a){if("#comment"===a.nodeName){if("unresolved component placeholder"===a.nodeValue)throw"unresolved"}else a.children&&h(a)})}var d=c(45),e=c(67);avalon.component=function(a,b){avalon.components[a]||(avalon.components[a]=b)},avalon.directive("widget",{priority:4,parse:function(a,b,c){b.props.wid=b.props.wid||avalon.makeHashCode("w"),a[c.name]=avalon.parseExpr(c),a.template=b.template,a.vmodel="__vmodel__",a.local="__local__"},define:function(){return avalon.mediatorFactory.apply(this,arguments)},diff:function(a,b,c,f,h,i){var k,l,m,n,o,p,q,r,j=a[c];if(Object(j)===j){if(k=b.props.is||(/^ms\-/.test(b.nodeName)?b.nodeName:0),k||(j=j.$model||j,Array.isArray(j)&&(j.unshift({}),avalon.mix.apply(0,j),j=j.shift()),k=j.is),l="component-vm:"+k,b.props.is=k,b.vmodel=a.vmodel,!b[l]&&!e(b,a[c],a.local,a.template))return b.nodeValue="unresolved component placeholder",f[i]=b,d(b,this.mountComment),void 0;if(m=b[l],n=avalon.scopes[m.$id],n&&n.vmodel&&(o=n.vmodel.$element,b.dom!==o))return p=o.vtree[0],h[i]=f[i]=p,b.com=o,p.skipContent||(p.skipContent="optimize"),d(b,this.replaceCachedComponent),d(p,function(){"optimize"===p.skipContent&&(p.skipContent=!0)},"afterChange"),void 0;q=m.$render,r=q(m,a.local),p=r[0],p&&g(p)?(p.local=a.local,Array(l,"component-html:"+k,"component-ready:"+k,"dom","dynamic").forEach(function(a){p[a]=b[a]}),p.vmodel=m,f[i]=p,b.comment&&b.nodeValue&&(p.dom=b.comment),b.nodeName!==p.nodeName?(h[i]=p,d(p,this.mountComponent)):d(b,this.updateComponent)):(b.nodeValue="unresolved component placeholder",f[i]={nodeValue:"unresolved component placeholder",nodeName:"#comment"},d(b,this.mountComment))}else b.props.is===a.props.is&&d(b,this.updateComponent)},replaceCachedComponent:function(a,b,c){var d=b.com;c.replaceChild(d,a),b.dom=d,delete b.com},mountComment:function(a,b,c){var d=document.createComment(b.nodeValue);b.dom=d,c.replaceChild(d,a)},updateComponent:function(a,b){var c=b["component-vm:"+b.props.is],e=c.$events.onViewChange;e&&e.length&&d(b,f,"afterChange")},mountComponent:function(a,b,c){var e,f,g;delete b.dom,e=avalon.vdom(b,"toDOM"),f=b.props.is,g=b["component-vm:"+f],g.$fire("onInit",{type:"init",vmodel:g,is:f}),c.replaceChild(e,a),b.dom=g.$element=e,e.vtree=[b],avalon.onComponentDispose(e),b["component-ready:"+f]=!0,avalon.scopes[g.$id]={vmodel:g,top:b.vmodel,local:b.local},d(b,function(){g.$fire("onReady",{type:"ready",target:e,vmodel:g,is:f})},"afterChange"),d(b,function(){b["component-html:"+f]=avalon.vdom(b,"toHTML")},"afterChange")}})},function(a,b,c){function j(a,b,c,f){function y(a,b){x.forEach(function(c){delete a[c],delete b[c]})}var q,r,s,t,u,v,w,x,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,j=a.nodeName,n=a.props.is;if(!e[j]&&!o(j))return avalon.warn(j+"不合适做组件的标签"),void 0;if(q={},b?(r=[].concat(b),r.forEach(function(a){a&&"object"==typeof a&&p(q,a.$model||a,!0)})):r=[],s=avalon.components[n]){if(t=q.id||q.$id,!t&&i&&(avalon.warn("warning!",n,"组件最好在ms-widget配置对象中指定全局不重复的$id以提高性能!\n","若在ms-for循环中可以利用 ($index,el) in @array 中的$index拼写你的$id\n","如 ms-widget=\"{is:'ms-button',id:'btn'+$index}\""),i=!1),u=q.define,u=u||avalon.directives.widget.define,v=t||a.props.id||"w"+(new Date-0),w=avalon.mix(!0,{},s.defaults),p(q,w,!1),x=h.concat(),y.isWidget=!0,z=u.apply(y,[a.vmodel,w].concat(r)),!avalon.modern)for(A in z)d[A]||"function"!=typeof z[A]||(z[A]=z[A].bind(z));z.$id=v,avalon.vmodels[v]=z;for(B in g)q[B]&&q[B].forEach(function(a){z.$watch(B,a)});return C=avalon.lexer(f),D=C[0],D.children=D.children||[],D.props.is=n,D.props.wid=v,avalon.speedUp(C),E=avalon.render(C,c),F=s.template.trim(),"function"==typeof s.getTemplate&&(F=s.getTemplate(z,F)),G=avalon.lexer(F),G.length>1&&avalon.error("组件必须用一个元素包起来"),H=s.soleSlot,m(G,H),avalon.speedUp(G),I=avalon.render(G),J=l+"",K=H?avalon.quote(H):"null",J=J.replace("XXXXX",k(E)).replace("YYYYY",k(I)).replace("ZZZZZ",K),L=J.indexOf("{")+1,M=J.lastIndexOf("}"),N=Function("vm","local",J.slice(L,M)),z.$render=N,a["component-vm:"+n]=z,z.$render=N}}function k(a){return a.toString().replace("anonymous","").replace(/\s*\/\*\*\//g,"")}function l(){var e,f,g,a=XXXXX(vm,local),b=a[0],c=YYYYY(vm,local),d=c[0];for(e in b)"children"!==e&&"nodeName"!==e&&("props"===e?avalon.mix(d.props,b.props):d[e]=b[e]);return f=ZZZZZ,g=avalon.collectSlots(b,f),!f||g[f]&&g[f].length||(g[f]=[{nodeName:"#text",nodeValue:vm[f],dynamic:!0}]),avalon.insertSlots(c,g),delete d.skipAttrs,delete d.skipContent,c}function m(a,b){var d,c,e;for(c=0;d=a[c];c++)"slot"===d.nodeName?(e=d.props.name||b,a.splice(c,1,{nodeName:"#comment",nodeValue:"slot:"+e,dynamic:!0,type:e},{nodeName:"#comment",nodeValue:"slot-end:"}),c++):d.children&&m(d.children,b)}function o(a){return n.test(a)||avalon.components[a]}function p(a,b,c){var d,e;for(d in b)e=b[d],g[d]?d in a?a[d].push(e):a[d]=[b[d]]:c&&(a[d]=e)}var n,d=c(68),e={wbr:1,xmp:1,template:1},f="onInit,onReady,onViewChange,onDispose",g=avalon.oneObject(f),h=f.split(",").concat("is","define"),i=!0;a.exports=j,avalon.insertSlots=function(a,b){var d,c,e;for(c=0;d=a[c];c++)"#comment"===d.nodeName&&b[d.type]?(e=[c+1,0].concat(b[d.type]),a.splice.apply(a,e),c+=b[d.type].length):d.children&&avalon.insertSlots(d.children,b)},avalon.collectSlots=function(a,b){var c={};return b?(c[b]=a.children,c.__sole__=b):a.children.forEach(function(b,d){var e=b.props&&b.props.slot;b.forExpr?c[e]=a.children.slice(d,d+2):Array.isArray(c[e])?c[e].push(b):c[e]=[b]}),c},n=/^[a-z]([a-z\d]+\-)+[a-z\d]+$/},function(a){a.exports=avalon.oneObject("$id,$render,$track,$element,$watch,$fire,$events,$model,$skipArray,$accessors,$hashcode,$run,$wait,__proxy__,__data__,__const__")},function(a,b,c){function g(a,b){for(var c in a)if(a[c]!==b[c])return!0;return!1}function i(){if(!h.lock){var a=h[0];a&&(i.lock=!0,a())}}function l(a){var b=k.test(a)?1e3:1;return parseFloat(a)*b}function m(a,b,c){var d=a[b];d=Array.isArray(d)?d:"function"==typeof d?[d]:[],d.forEach(function(a){a&&a(c)})}function o(a){var b=a.toLowerCase();return function(c){var g,k,o,p,e=this.el,f=avalon(e),j=isFinite(c.stagger)?1e3*c.stagger:0;j&&c.staggerKey&&(k=n.get(c.staggerKey)||n.put(c.staggerKey,{count:0,items:0}),k.count++,k.items++),o=k&&k.count||0,p=function(b){var j,f=b!==!1;e.animating=void 0,g=!0,j=f?"Done":"Abort",m(c,"on"+a+j,e),avalon.unbind(e,d.transitionEndEvent),avalon.unbind(e,d.animationEndEvent),k&&0===--k.items&&(k.count=0),c.queue&&(h.lock=!1,h.shift(),i())},m(c,"onBefore"+a,e),c[b]?c[b](e,function(a){p(a!==!1)}):d.css&&(f.addClass(c[b+"Class"]),"leave"===b?f.removeClass(c.enterClass+" "+c.enterActiveClass):"enter"===b&&f.removeClass(c.leaveClass+" "+c.leaveActiveClass),f.bind(d.transitionEndEvent,p),f.bind(d.animationEndEvent,p),setTimeout(function(){var a,h,i,k;g=0/0===avalon.root.offsetWidth,f.addClass(c[b+"ActiveClass"]),a=window.getComputedStyle(e),h=a[d.transitionDuration],i=a[d.animationDuration],k=l(h)||l(i),0===!k?p(!1):j||setTimeout(function(){g||p(!1)},k+130)},17+j*o))}}function p(a){a.acton||(a.action=a.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase())}var h,j,k,n,d=c(70),e=c(31),f=c(45);avalon.directive("effect",{priority:5,diff:function(a,b,c){var e,d=a[c];d=a.$model||d,"string"==typeof d?(e=d,d={is:e}):Array.isArray(d)&&(d=avalon.mix.apply({},d)),d.action=d.action||"enter",Object(d)===d&&(!b.dynamic[c]||g(d,b[c]||{}))&&(b[c]=d,f(b,this.update,"afterChange")),a!==b&&delete a[c]},update:function(a,b,c,e){var f,g,j,k,l,m,n,o,p;if(a&&1===a.nodeType&&!a.animating){if(a.animating=!0,f=b["ms-effect"],b.dynamic["ms-effect"]||(g=f.cb||avalon.noop,f.cb=[function(){b.dynamic["ms-effect"]=1,f.cb=g}].concat(g)),j=f.is,e=e||{},!j)return avalon.warn("need is option");if(k=avalon.effects,d.css&&!k[j]&&avalon.effect(j,{}),l=k[j],!l)return avalon.warn(j+" effect is undefined");m=e.action||f.action,n=avalon.Effect,o=new n(a),p=avalon.mix(e,l,f),p.queue?(h.push(function(){o[m](p)}),i()):setTimeout(function(){o[m](p)},4)}}}),h=[],avalon.effects={},avalon.effect=function(a,b){avalon.effects[a]=b||{},d.css&&(b.enterClass||(b.enterClass=a+"-enter"),b.enterActiveClass||(b.enterActiveClass=b.enterClass+"-active"),b.leaveClass||(b.leaveClass=a+"-leave"),b.leaveActiveClass||(b.leaveActiveClass=b.leaveClass+"-active")),b.action||(b.action="enter")},j=function(a){this.el=a},avalon.Effect=j,j.prototype={enter:o("Enter"),leave:o("Leave"),move:o("Move")},k=/\d+s$/,n=new e(128),avalon.applyEffect=function(a,b,c){var f,g,d=c.cb,e=b["ms-effect"];e&&a&&1===a.nodeType?(f=c.hook,g=e[f],d&&(Array.isArray(g)?g.push(d):e[f]=g?[g,d]:[d]),p(c),avalon.directives.effect.update(a,b,0,avalon.shadowCopy({},c))):d&&d(a)}},function(a){var c,d,e,f,g,h,i,j,k,l,m,p;if(avalon.browser){c=!1,d=!1,e=!1,h=avalon.cssName("transition-duration"),i=avalon.cssName("animation-duration"),j={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"},k=avalon.window;for(m in j){if(k[m]){l=j[m];break}try{document.createEvent(m),l=j[m];break}catch(o){}}"string"==typeof l&&(c=!0,e=!0,f=l),j={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};for(m in j)if(k[m]){p=j[m];break}"string"==typeof p&&(d=!0,e=!0,g=p)}a.exports={transition:c,animation:d,css:e,transitionEndEvent:f,animationEndEvent:g,transitionDuration:h,animationDuration:i}},function(a,b,c){function f(a,b){var g,h,i,c=Array.isArray(a)?d(a):a,f=[];if(b)for(g in b)f.push("var "+g+" = __local__["+avalon.quote(g)+"]");c=c.replace(e,"$1"),h="__local__ = __local__ || {};\n"+f.join(";\n")+"\n"+c;try{i=Function("__vmodel__","__local__",h)}catch(j){avalon.warn(c,"render parse error")}return i}var d,e;avalon.lexer=c(72),avalon.diff=c(76),avalon.batch=c(77),d=c(38),e=/\\\\(['"])/g,avalon.render=f,a.exports=avalon},function(a,b,c){function q(a){var b="??"+o++;return p[b]=a,b}function r(a){var b=p[a];return b}function s(a){var b,c,f,m,n,o,q,s,v,z,A,B,C,D;p={},a=y(a),b=[],b.last=function(){return b[b.length-1]},c=[],f=1e5;do{if(m=!1,"<"!==a.charAt(0)&&(n=a.indexOf("<"),n=-1===n?a.length:n,o=a.slice(0,n).replace(l,r),a=a.slice(n),m={nodeName:"#text",nodeValue:o},k.test(o)&&u(m,b,c)),m||(n=a.indexOf("<!--"),0===n&&(q=a.indexOf("-->"),-1===q&&d.error("注释节点没有闭合"+a),o=a.slice(4,q).replace(l,r),a=a.slice(q+3),m={nodeName:"#comment",nodeValue:o},u(m,b,c))),m||(s=a.match(i),s&&(v=s[1].toLowerCase(),z=e[v]||"/"===s[3],m={nodeName:v,props:{},children:[],isVoidTag:z},A=s[2],A&&w(A,m.props),u(m,b,c),a=a.slice(s[0].length),z?m.end=!0:(b.push(m),h[v]&&(B=a.indexOf("</"+v+">"),C=a.slice(0,B).trim(),a=a.slice(B),g(m,v,x(C)))))),m||(s=a.match(j),s&&(v=s[1].toLowerCase(),D=b.last(),D?D.nodeName!==v&&d.error(D.nodeName+"没有闭合"):d.error(s[0]+"前面缺少<"+v+">"),m=b.pop(),m.end=!0,a=a.slice(s[0].length))),!m||0===--f)break;m.end&&(t(m,b,c),delete m.end)}while(a.length);return c}function t(a,b,c){var g,h,i,d=a.nodeName,e=a.props;"table"===d&&f(a.children),g=e["ms-for"],g&&(delete e["ms-for"],h=b.last(),i=h?h.children:c,i.splice(i.length-1,1,{nodeName:"#comment",nodeValue:"ms-for:"+g,type:d},a,{nodeName:"#comment",nodeValue:"ms-for-end:",type:d}))}function u(a,b,c){var d=b.last();d?d.children.push(a):c.push(a)}function w(a,b){for(var c,d,e;a&&(c=v.exec(a));)d=c[1],e=c[2]||"",a=a.replace(c[0],""),":"===d.charAt(0)&&(d="ms-"+d.slice(1)),e&&0===e.indexOf("??")&&(e=x(e).replace(m,"").slice(1,-1)),d in b||(b[d]=e)}function x(a){return d.unescapeHTML(a.replace(l,r))}function y(a){var c,d,b=z(a);for(c=0,d=b.length;d>c;c++)a=a.replace(b[c],q);return a}function z(a){var b,e,f,g,c=0,d=[];for(e=0,f=a.length;f>e;e++)if(g=a.charAt(e),b){if("\\"===g){e+=1;continue}g===b&&(d.push(a.slice(c,e+1)),b=!1)}else"'"===g?(b="'",c=e):'"'===g&&(b='"',c=e);return d}var e,f,g,h,i,j,k,l,m,o,p,v,d=c(4);c(73),e=c(37),f=c(74),g=c(75),h=d.oneObject("script,style,textarea,xmp,noscript,option,template"),i=/^<([-A-Za-z0-9_]+)\s*([^>]*?)(\/?)>/,j=/^<\/([^>]+)>/,k=/\S/,l=/\?\?\d+/g,m=/\n\s*/g,o=1,p={},a.exports=s,v=/([^=\s]+)(?:\s*=\s*(\S+))?/},function(a,b,c){function h(a){var c,d,e,f,h,j,k,l,m,b=a.nodeName;switch(b){case"#text":return avalon.config.rexpr.test(a.nodeValue)?a.dynamic=!0:!1;case"#comment":return a.dynamic?!0:!1;case void 0:return!0;default:if(c=a.props||{},"ms-skip"in c)return a.skipContent=!0,!1;d=!1,"input"===b?c.type||(c.type="text"):"select"===b?(e=c.hasOwnProperty("multiple")?"multiple":"one",c.type=b+"-"+e):0===b.indexOf("ms-")&&(c["ms-widget"]||(c.is=b,c["ms-widget"]='{is:"'+b+'"}')),f=!1,c["ms-widget"]&&(f=!0,i(c,"html","widget"),i(c,"text","widget"),h=avalon.mix({},a),j=avalon.mix({},a.props),delete j["ms-widget"],delete h.isVoidTag,h.nodeName="cheng",h.props=j,a.template=avalon.vdom(h,"toHTML"),a.isVoidTag||(a.children=[])),c["ms-text"]&&(f=!0,i(c,"html","text"),a.isVoidTag||(a.children=[])),c["ms-html"]&&(f=!0,a.isVoidTag||(a.children=[])),k=!1;for(l in c)if(k=!0,0===l.indexOf("ms-")){d=!0,a.dynamic={};break}if(k&&(a.props=c),a.children){if(m=g(a.children))return delete a.skipContent,!0;f?delete a.skipContent:a.skipContent=!0}return d}}function i(a,b,c){a["ms-"+b]&&(avalon.warn(b,"指令不能与",c,"指令共存于同一个元素"),delete a["ms-"+b])}function j(a){for(var c,b=0;c=a[b++];)if(c.props&&c.props["ms-effect"])return!0;return!1}var g,d=/^\s*ms\-for\:/,e=/^\s*ms\-for\-end/,f=c(38);avalon.speedUp=function(a){return g(a),a},g=function(a){var i,k,l,m,n,o,p,q,r,s,t,b=[],c=!1;for(i=0;i<a.length;i++)if(k=a[i],l="#comment"===k.nodeName,l&&d.test(k.nodeValue))c=!0,b.push(k),m=b,b=[],b.list=m,b.start=k;else if(l&&e.test(k.nodeValue)){for(m=b,b=m.list,n=m.start,delete m.list,delete m.start,b.push(m,k),k.dynamic=!0,o=n.signature||(n.signature=avalon.makeHashCode("for")),k.signature=o,n.forExpr=n.nodeValue.replace(/ms\-for:\s*/,""),1===m.length&&(p=m[0],p.props&&(p.props.slot&&(n.props='{slot: "'+p.props.slot+'"}'),q=p.props["data-for-rendered"],q&&(delete p.props["data-for-rendered"],r=q+":cb",avalon.caches[r]||(avalon.caches[r]=Function("return "+avalon.parseExpr(q,"on"))()),n.wid=r))),s=0;s<m.length;s++)k=m[s],t=k.dom,t&&t.parentNode&&t.parentNode.removeChild(t);n.hasEffect=j(m),g(m),avalon.caches[o]||(avalon.caches[o]=f(m,!0)),m.length=0}else h(k)&&(c=!0),b.push(k);return a.length=0,a.push.apply(a,b),c}},function(a){a.exports=function(a){var b,g,h,c=!1,d=0,e=0,f=a.length;for(g=0;f>g;g++)h=a[g],b?"tr"!==h.nodeName&&h.children?b=!1:(b.children.push(h),d++,a[g]=0):"tr"===(h.type||h.nodeName)&&(b={nodeName:"tbody",children:[]},b.children.push(h),h.type&&delete h.type,c=!0,0===e&&(e=g),a[g]=b);if(c)for(g=e;f>g&&(0!==a[g]||(a.splice(g,1),g--,d--,0!==d));g++);}},function(a){function c(a,b,c){switch(b){case"style":case"script":case"noscript":case"template":case"xmp":a.children=[{nodeName:"#text",skipContent:!0,nodeValue:c}];break;case"textarea":var d=a.props;d.type="textarea",d.value=c,a.children=[];break;case"option":a.children=[{nodeName:"#text",nodeValue:e(c)}]}}function e(a){return String(a).replace(d,"").trim()}var d=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi;a.exports=c},function(a){function g(a,b){var c,f,j,k,l;for(c=0;c<a.length;c++)switch(f=a[c],j=b[c]||a[c],f.nodeName){case"#text":f.dynamic&&(k=f.nodeValue+"",k!==j.nodeValue&&(j.nodeValue=k,j.dom&&(j.dom.nodeValue=k)));break;case"#comment":f.forExpr?e["for"].diff(f,j,a,b,c):j.afterChange&&h(j,j.afterChange);break;case void 0:g(f,j);break;case"#document-fragment":g(f.children,j.children);break;default:f.dynamic&&(l=c,f["ms-widget"]&&(avalon.directives["widget"].diff(f,j,"ms-widget",a,b,l),f=a[c],j=b[c]||d(),delete f["ms-widget"]),"ms-if"in f&&(avalon.directives["if"].diff(f,j,"ms-if",a,b,l),f=a[c],j=b[c]||d(),delete f["ms-if"]),i(f,j)),!/^\w/.test(f.nodeName)||f.skipContent||f.isVoidTag||g(f.children,j.children||[]),j.afterChange&&h(j,j.afterChange)}}function h(a,b){if(b.length)for(var c,d=0;c=b[d++];)c(a.dom,a);delete a.afterChange}function i(a,b){var d,e,g,c=avalon.directives;try{for(d in a)e=d.match(f),g=e&&e[1],c[g]&&c[g].diff(a,b,d)}catch(h){avalon.warn(g,h,h.stack||h.message,"diffProps error")}}var d=function(){return{children:[],props:{}}},e=avalon.directives,f=/^ms-(\w+)-?(.*)/;avalon.diff=g,avalon.diffProps=i,a.exports=g},function(a){function e(a){var b,f,g,h,i,j,k,l,m;return d?avalon.Array.ensure(c,a):(d=a,b=avalon.scopes[a],b&&document.nodeName&&!avalon.suspendUpdate?(f=b.vmodel,g=f.$element,h=g.vtree||[],i=f.$render,j=i(b.vmodel,b.local),b.isTemp&&delete avalon.scopes[a],avalon.diff(j,h),k=c.indexOf(d),d=0,k>-1?(l=c.splice(k,1),e(l[0])):(m=c.shift(),m&&e(m),void 0)):d=null)}var c=[],d=!1;avalon.suspendUpdate=0,a.exports=avalon.batch=e},function(a,b,c){function h(a){a.addEventListener("DOMNodeRemovedFromDocument",function(){g(a)})}function i(){function b(b,c){var d=a[b];a[b]=function(a,b){return c.call(this,d,a,b)}}function e(a){var b=avalon.slice(this.getElementsByTagName("*"));d.call(this,a),f(b)}var a,d,c,h;if(!i.execute){i.execute=!0,a=Node.prototype,b("removeChild",function(a,b,c){return a.call(this,b,c),1===b.nodeType&&g(b),b}),b("replaceChild",function(a,b,c){return a.call(this,b,c),1===b.nodeType&&g(b),b}),c=Element.prototype;try{h=Object.getOwnPropertyDescriptor(c,"innerHTML"),d=h.set,h.set=e,Object.defineProperty(c,"innerHTML",h)}catch(j){if(!c||!c.__lookupSetter__)throw j;d=c.__lookupSetter__("innerHTML"),c.__defineSetter__("innerHTML",e)}b("appendChild",function(a,b){return a.call(this,b),1===b.nodeType&&11===this.nodeType&&g(b),b}),b("insertBefore",function(a,b,c){return a.call(this,b,c),1===b.nodeType&&11===this.nodeType&&g(b),b})}}function l(a){avalon.Array.ensure(j,a),k||(k=setInterval(function(){for(var b,a=0;b=j[a];)!1===e(b)?avalon.Array.removeAt(j,a):a++;0==j.length&&(clearInterval(k),k=0)},700))}function m(a){if(window.chrome&&window.MutationEvent)h(a);else try{i(a)}catch(b){l(a)}}var d=c(79),e=d.fireDisposeHook,f=d.fireDisposeHooks,g=d.fireDisposeHookDelay,j=[],k=0;m.byMutationEvent=h,m.byRewritePrototype=i,m.byPolling=l,a.exports=m},function(a){function c(a){for(;a;){if(9===a.nodeType)return!0;a=a.parentNode}return!1}function d(a){var b,d,e,g,h;if(1===a.nodeType&&a.getAttribute("wid")&&!c(a)){if(b=a.getAttribute("wid"),d=avalon.scopes[b],!d)return;return e=d.vmodel,d.vmodel.$fire("onDispose",{type:"dispose",target:a,vmodel:e}),d&&!a.getAttribute("cached")&&(delete d.vmodel,delete avalon.scopes[b],g=a.getAttribute("is"),h=a.vtree,f(h),h&&(h[0][g+"-mount"]=!1,h[0]["component-ready:"+g]=!1)),!1}}function f(a){var b,c;for(b in a)if(c=a[b],e.test(c.nodeName)){for(b in c)0===b.indexOf("ms-on")&&delete c[b];c.children&&f(c.children)}}function g(a){setTimeout(function(){d(a)},4)}function h(a){for(var c,b=0;c=a[b++];)d(c)}var e=/^\w/;a.exports={fireDisposeHookDelay:g,fireDisposeHooks:h,fireDisposeHook:d}},,,function(a,b,c){function i(a,b){b.__vmodel__=a;var c=d.hideProperty;c(a,"$events",b),c(a,"$watch",function(){if(2===arguments.length)return h.apply(a,arguments);throw"$watch方法参数不对"}),c(a,"$fire",function(b,c,d){var e=a.$events[b];g(e,a,b,c,d)})}function k(a,b,c){return"$"===a.charAt(0)||c[a]||j.test(avalon.type(b))||b&&b.nodeName&&b.nodeType>0}function l(a,b,c,f){var g,h;if(Array.isArray(a))return d.arrayFactory(a,b,c,f);if(Object(a)===a&&"function"!=typeof a){if(b&&b.$id){++avalon.suspendUpdate,g=b.$track!==Object.keys(a).sort().join(";;")?d.slaveFactory(b,a,c,f):b;for(h in a)e[h]||(g[h]=a[h]);return--avalon.suspendUpdate,g}return g=d.masterFactory(a,c,f)}return a}function m(a,b,c){function f(){return e}var e=0/0;return f.heirloom=c,{get:f,set:function(h){var i,j;if(e!==h&&(i=c.__vmodel__,h&&"object"==typeof h&&(h=d.modelAdaptor(h,e,c,{pathname:b,id:a})),j=e,e=h,this.$hashcode&&i)){if(i.$events.$$dirty$$=!0,i.$events.$$wait$$)return;c!==i.$events&&(f.heirloom=i.$events),q(f.$decompose,b,h,j),-1===b.indexOf("*")&&g(f.heirloom[b],i,b,h,j),p(a+"",i,b,h,j),r(f.heirloom,i,b,h,j),i.$events.$$dirty$$=!1,n(i.$id)}},enumerable:!0,configurable:!0}}function n(a){avalon.rerenderStart=new Date;var b=a.indexOf(".");b>0?avalon.batch(a.slice(0,b)):avalon.batch(a)}function p(a,b,c,d,e){var f,h,i;a.indexOf(".*.")>0&&(f=a.match(o),h=avalon.vmodels[f[1]],h&&(i=f[2],g(h.$events[i],b,c,d,e)))}function q(a,b,c,d){var e,f;a&&a[b]&&(e=a[b],e.$hashcode?(f=b.replace(/^[^.]+\./,""),f!==b&&g(e.$events[f],e,f,c,d)):delete a[b])}function r(a,b,c,d,e){a.__fuzzy__&&a.__fuzzy__.replace(avalon.rword,function(f){var h=a[f],i=h.reg;return i&&i.test(c)&&g(h,b,c,d,e),f})}function s(a){var c,b=a.$id;if(b||avalon.warn("vm.$id must be specified"),avalon.vmodels[b])throw Error("error:["+b+"] had defined!");return c=d.masterFactory(a,{},{pathname:"",id:b,master:!0}),avalon.vmodels[b]=c}function t(a,b,c,e){var f,g,h,i,j;if(b&&b.splice)return f=[0,b.length].concat(a),++avalon.suspendUpdate,avalon.callArray=e.pathname,b.splice.apply(b,f),--avalon.suspendUpdate,b;for(g in u)a[g]=u[g];for(a.notify=function(a,b,d,f){var h,g=c.__vmodel__;g&&(h=null===a||void 0===a?e.pathname:e.pathname+"."+a,g.$fire(h,b,d),f||c.$$wait$$||avalon.suspendUpdate||(avalon.callArray=h,n(g.$id),delete avalon.callArray))},h=avalon.makeHashCode("$"),e.array=!0,e.hashcode=h,e.id=e.id||h,d.initViewModel(a,c,{},{},e),i=0,j=a.length;j>i;i++)a[i]=l(a[i],0,{},{id:a.$id+".*",master:!0});return a}var o,u,d={},e=c(68),f=c(83),g=f.$emit,h=f.$watch,j=/function|window|date|regexp|element/i;d.modelAdaptor=l,o=/([^.]+)\.(.+)/,d.arrayFactory=t,u={set:function(a,b){if(a>>>0===a&&this[a]!==b){if(a>this.length)throw Error(a+"set方法的第一个参数不能大于原数组长度");this.splice(a,1,b)}},contains:function(a){return-1!==this.indexOf(a)},ensure:function(a){return this.contains(a)||this.push(a),this},pushArray:function(a){return this.push.apply(this,a)},remove:function(a){return this.removeAt(this.indexOf(a))},removeAt:function(a){return a>>>0===a?this.splice(a,1):[]},clear:function(){return this.removeAll(),this}},avalon.define=s,a.exports={$$midway:d,$$skipArray:e,isSkip:k,__array__:u,initEvents:i,makeAccessor:m,modelAdaptor:l}},function(a){function c(a,b){var d,c=b.split(".")[0];try{a.hasOwnProperty(c)&&(d=a.$accessors?a.$accessors[c].get.heirloom.__vmodel__:Object.getOwnPropertyDescriptor(a,c).get.heirloom.__vmodel__)}catch(e){}return d||a}function d(a){var b=a.split(".");return new RegExp("^"+b.map(function(a){return"*"===a?"(?:[^.]+)":a}).join("\\.")+"$","i")}function e(a,b,c){a&&(b.__fuzzy__?-1===b.__fuzzy__.indexOf(","+c)&&(b.__fuzzy__+=","+c):b.__fuzzy__=c)}function f(a,b){var c=a.indexOf(".*")>0||"*"===a,g=c?this:f.adjust(this,a),h=this.$events,i=h[a]||(h[a]=[]);return c&&(i.reg=i.reg||d(a)),e(c,h,a),g!==this&&e(c,this.$events,a),avalon.Array.ensure(i,b),function(){avalon.Array.remove(i,b)}}function g(a,b,c,d,e,f){if(a&&a.length)try{for(f=f||a.length-1;f>=0;f--){var h=a[f];h.call(b,d,e,c)}}catch(i){f-1>0&&g(a,b,c,d,e,f-1),avalon.log(i,c)}}f.adjust=c,a.exports={$emit:g,$watch:f,adjustVm:c}},,,function(a,b,c){c(3),c(87),c(6),a.exports=c(7)},function(a,b,c){function i(a){if(a&&"object"==typeof a){var b=a.length,c=e.call(a);
if(g.test(c))return!0;if("[object Object]"===c&&b===b>>>0)return!0}return!1}var d=c(4),e=d.inspect,f=/^\[object (?:Window|DOMWindow|global)\]$/,g=/(Array|List|Collection|Map|Arguments)\]$/,h={};"Boolean Number String Function Array Date RegExp Object Error".replace(d.rword,function(a){h["[object "+a+"]"]=a.toLowerCase()}),d.type=function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?h[e.call(a)]||"object":typeof a},d.quote=JSON.stringify,d.isFunction=function(a){return"function"==typeof a},d.isWindow=function(a){return f.test(e.call(a))},d.isPlainObject=function(a){return"[object Object]"===e.call(a)&&Object.getPrototypeOf(a)===Object.prototype},d.mix=d.fn.mix=function(){var a,b,c,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[1]||{},i++),"object"!=typeof h&&"function"!=typeof h&&(h={}),i===j&&(h=this,i--);j>i;i++)if(null!=(a=arguments[i]))for(b in a){c=h[b];try{e=a[b]}catch(l){continue}h!==e&&(k&&e&&(d.isPlainObject(e)||(f=Array.isArray(e)))?(f?(f=!1,g=c&&Array.isArray(c)?c:[]):g=c&&d.isPlainObject(c)?c:{},h[b]=d.mix(k,g,e)):void 0!==e&&(h[b]=e))}return h},d.each=function(a,b){var c,d;if(a)if(c=0,i(a))for(d=a.length;d>c&&b(c,a[c])!==!1;c++);else for(c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)break},a.exports={avalon:d,isArrayLike:i}},function(a,b,c){var h,d=c(16),e=c(18),f=c(89),g=c(20);avalon.vdom=avalon.vdomAdaptor=function(a,b){if(!a)return"toHTML"===b?"":document.createDocumentFragment();switch(a.nodeName){case"#text":return d.prototype[b].call(a);case"#comment":return e.prototype[b].call(a);case"#document-fragment":return g.prototype[b].call(a);case void 0:return new g(a)[b]();default:return f.prototype[b].call(a)}},h={VText:d,VComment:e,VElement:f,VFragment:g},avalon.shadowCopy(avalon.vdom,h),a.exports=h},function(a){function c(a,b,c){this.nodeName=a,this.props=b,this.children=c}function d(a){return a!==!1&&Object(a)!==a}function e(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}var h,f=avalon.oneObject("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use,g,svg");avalon.browser&&(h="content"in document.createElement("template")),c.prototype={constructor:c,toDOM:function(){var a,b,c,g,i,j,k,l,m,n,o;if(this.dom)return this.dom;if(b=this.nodeName,a=avalon.modern&&f[b]?e(b):document.createElement(b),c=this.props||{},g=c["ms-important"]||c["ms-controller"]||this.wid,g&&(i=avalon.scopes[g],j=i&&i.vmodel&&i.vmodel.$element))return k=j.vtree[0],k.children&&(this.children=k.children),j;for(l in c)m=c[l],d(m)&&a.setAttribute(l,m+"");switch(n=this.children||[],o=n[0]?n[0].nodeValue:"",this.nodeName){case"xmp":case"script":case"style":case"noscript":a.innerHTML=o;break;case"template":h?a.innerHTML=o:a.textContent=o;break;default:this.isVoidTag||this.children.forEach(function(b){b&&a.appendChild(avalon.vdom(b,"toDOM"))})}return this.dom=a},toHTML:function(){var c,e,f,a=[],b=this.props||{};for(c in b)e=b[c],d(e)&&a.push(c+"="+avalon.quote(b[c]+""));return a=a.length?" "+a.join(" "):"",f="<"+this.nodeName+a,this.isVoidTag?f+"/>":(f+=">",this.children&&(f+=this.children.map(function(a){return a?avalon.vdom(a,"toHTML"):""}).join("")),f+"</"+this.nodeName+">")}},a.exports=c},function(a,b,c){c(91),c(92),c(93),c(94),c(95),c(30),c(96),c(97),a.exports=avalon},function(a,b,c){var d=c(4);"function"==typeof Node&&(document.contains||(Node.prototype.contains=function(a){return!!(16&this.compareDocumentPosition(a))})),d.cloneNode=function(a){return a.cloneNode(!0)},d.contains=function(a,b){try{for(;b=b.parentNode;)if(b===a)return!0;return!1}catch(c){return!1}}},function(a,b,c){var d=c(4),e=/\S+/g;"add,remove".replace(d.rword,function(a){d.fn[a+"Class"]=function(b){var c=this[0]||{};return b&&"string"==typeof b&&1===c.nodeType&&b.replace(e,function(b){c.classList[a](b)}),this}}),d.fn.mix({hasClass:function(a){var b=this[0]||{};return 1===b.nodeType&&b.classList.contains(a)},toggleClass:function(a,b){var c="boolean"==typeof b,d=this;return String(a).replace(e,function(a){var e=c?b:!d.hasClass(a);d[e?"addClass":"removeClass"](a)}),this}})},function(a,b,c){function g(a,b){var d,g,h,i,j,k,c=b.changeAttr;if(c){b.dynamic["ms-attr"]=1;for(d in c)if(g=c[d],"src"===d&&window.chrome&&"EMBED"===a.tagName)a[d]=g,h=a.parentNode,i=document.createComment("ms-src"),h.replaceChild(i,a),h.replaceChild(a,i);else if(0==d.indexOf("data-"))a.setAttribute(d,g);else{if(j=e[d]||d,"boolean"==typeof a[j]&&(a[j]=!!g),g===!1){a.removeAttribute(d);continue}k=f.test(a)?!1:d in a.cloneNode(!1),k?a[j]=g+"":a.setAttribute(d,g)}}b.changeAttr=null}var d=c(4),e=c(26),f=/^\[object SVG\w*Element\]$/;d.parseJSON=JSON.parse,d.fn.attr=function(a,b){return 2===arguments.length?(this[0].setAttribute(a,b),this):this[0].getAttribute(a)},a.exports=g},function(a,b,c){function l(a,b){var c,d,e,f;if(a.offsetWidth<=0){if(c=getComputedStyle(a,null),k.test(c["display"])){d={node:a};for(e in j)d[e]=c[e],a.style[e]=j[e];b.push(d)}f=a.parentNode,f&&1===f.nodeType&&l(f,b)}}function m(a){return a.window||a.defaultView||!1}var j,k,d=c(4),e=d.root,f=d.camelize,g=d.cssHooks,h=["","-webkit-","-o-","-moz-","-ms-"],i={"float":"cssFloat"};d.cssNumber=d.oneObject("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),d.cssName=function(a,b,c){if(i[a])return i[a];b=b||e.style;for(var d=0,g=h.length;g>d;d++)if(c=f(h[d]+a),c in b)return i[a]=c;return null},d.fn.css=function(a,b){var c,e;if(d.isPlainObject(a))for(c in a)d.css(this,c,a[c]);else e=d.css(this,a,b);return void 0!==e?e:this},d.fn.position=function(){var a,b,c=this[0],e={top:0,left:0};return c?("fixed"===this.css("position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),"HTML"!==a[0].tagName&&(e=a.offset()),e.top+=d.css(a[0],"borderTopWidth",!0),e.left+=d.css(a[0],"borderLeftWidth",!0),e.top-=a.scrollTop(),e.left-=a.scrollLeft()),{top:b.top-e.top-d.css(c,"marginTop",!0),left:b.left-e.left-d.css(c,"marginLeft",!0)}):e},d.fn.offsetParent=function(){for(var a=this[0].offsetParent;a&&"static"===d.css(a,"position");)a=a.offsetParent;return d(a||e)},g["@:set"]=function(a,b,c){a.style[b]=c},g["@:get"]=function(a,b){if(!a||!a.style)throw new Error("getComputedStyle要求传入一个节点 "+a);var c,d=getComputedStyle(a);return d&&(c="filter"===b?d.getPropertyValue(b):d[b],""===c&&(c=a.style[b])),c},g["opacity:get"]=function(a){var b=g["@:get"](a,"opacity");return""===b?"1":b},"top,left".replace(d.rword,function(a){g[a+":get"]=function(b){var c=g["@:get"](b,a);return/px$/.test(c)?c:d(b).position()[a]+"px"}}),j={position:"absolute",visibility:"hidden",display:"block"},k=/^(none|table(?!-c[ea]).+)/,d.each({Width:"width",Height:"height"},function(a,b){var c="client"+a,e="scroll"+a,f="offset"+a;g[b+":get"]=function(b,c,e){var h,g=-4;return"number"==typeof e&&(g=e),c="Width"===a?["Left","Right"]:["Top","Bottom"],h=b[f],2===g?h+d.css(b,"margin"+c[0],!0)+d.css(b,"margin"+c[1],!0):(0>g&&(h=h-d.css(b,"border"+c[0]+"Width",!0)-d.css(b,"border"+c[1]+"Width",!0)),-4===g&&(h=h-d.css(b,"padding"+c[0],!0)-d.css(b,"padding"+c[1],!0)),h)},g[b+"&get"]=function(a){var d,f,e,h,c=[];for(l(a,c),d=g[b+":get"](a),e=0;f=c[e++];){a=f.node;for(h in f)"string"==typeof f[h]&&(a.style[h]=f[h])}return d},d.fn[b]=function(d){var i,h=this[0];return 0===arguments.length?h.setTimeout?h["inner"+a]:9===h.nodeType?(i=h.documentElement,Math.max(h.body[e],i[e],h.body[f],i[f],i[c])):g[b+"&get"](h):this.css(b,d)},d.fn["inner"+a]=function(){return g[b+":get"](this[0],void 0,-2)},d.fn["outer"+a]=function(a){return g[b+":get"](this[0],void 0,a===!0?2:0)}}),d.fn.offset=function(){var b,c,d,e,a=this[0];try{if(b=a.getBoundingClientRect(),b.width||b.height||a.getClientRects().length)return c=a.ownerDocument,d=c.documentElement,e=c.defaultView,{top:b.top+e.pageYOffset-d.clientTop,left:b.left+e.pageXOffset-d.clientLeft}}catch(f){return{left:0,top:0}}},d.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){d.fn[a]=function(c){var d=this[0]||{},e=m(d),f="scrollTop"===a;return arguments.length?(e?e.scrollTo(f?e[b]:c,f?c:e[b]):d[a]=c,void 0):e?e[b]:d[a]}})},function(a,b,c){function e(a){var b=a.tagName.toLowerCase();return"input"===b&&/checkbox|radio/.test(a.type)?"checked":b}var d=c(4),f={"select:get":function g(a,b,c,d){var h,k,j,e=a.children;for(f["option:get"],c=b?c:a.selectedIndex,d=b?d:"select-one"===a.type||0>c,b=b||[],j=0;k=e[j++];)if(!k.disabled)switch(k.nodeName.toLowerCase()){case"option":if(k.selected||k.index===c){if(h=k.value,d)return h;b.push(h)}break;case"optgroup":if(h=g(k,b,c,d),"string"==typeof h)return h}return d?null:b},"select:set":function(a,b,c){b=[].concat(b);for(var e,d=0;e=a.options[d++];)(e.selected=b.indexOf(e.value)>-1)&&(c=!0);c||(a.selectedIndex=-1)}};d.fn.val=function(a){var c,d,g,h,b=this[0];if(b&&1===b.nodeType)if(c=0===arguments.length,d=c?":get":":set",g=f[e(b)+d])h=g(b,a);else{if(c)return(b.value||"").replace(/\r/g,"");b.value=a}return c?h:this}},function(a,b,c){function l(a,b,c){var f,g,h,e=a.getAttribute("avalon-events");!e||a.disabled===!0&&"click"===b||(f=[],g=k[b]||(k[b]=new RegExp("\\b"+b+"\\:([^,\\s]+)","g")),e.replace(g,function(a,b){return f.push(b),a}),f.length&&c.push({elem:a,uuids:f})),a=a.parentNode,h=d.gestureEvents||{},a&&a.getAttribute&&(i[b]||h[b])&&l(a,b,c)}function o(a){var b,c,e,g,h,i,f,j,k,o,p;for(a=new u(a),b=a.type,c=a.target,e=[],l(c,b,e),f=0;(i=e[f++])&&!a.cancelBubble;)for(j=a.currentTarget=i.elem,g=0;h=i.uuids[g++];){if(n){n=!1;break}if(k=d.eventListeners[h]){if(o=m.test(h)?i.elem._ms_context_:0,o&&o.$hashcode===!1)return d.unbind(c,b,k);p=k.call(o||c,a,j._ms_local),p===!1&&(a.preventDefault(),a.stopPropagation())}}}function s(a){var c,b=g.getAttribute("delegate-events")||"";-1===b.indexOf(a)&&(c=b.match(d.rword)||[],c.push(a),g.setAttribute("delegate-events",c.join(",")),q(g,a,o,!!p[a]))}function u(a){if(a.originalEvent)return this;for(var b in a)t.test(b)||"function"==typeof a[b]||(this[b]=a[b]);this.timeStamp=new Date-0,this.originalEvent=a}var k,m,n,p,q,r,t,d=c(4),e=d.document,f=d.window,g=d.root,h=c(6).getShortID,i=c(33),j=d.eventHooks;d.bind=function(a,b,c){var e,f,g,k,l;return 1===a.nodeType?(e=a.getAttribute("avalon-events")||"",f=h(c),g=j[b],g&&(b=g.type||b,g.fix&&(c=g.fix(a,c),c.uuid=f)),"click"!==b||a.onclick||(a.onclick=""),k=b+":"+f,d.eventListeners[c.uuid]=c,-1===e.indexOf(b+":")&&(i[b]||p[b]?s(b):q(a,b,o)),l=e.split(","),""===l[0]&&l.shift(),-1===l.indexOf(k)&&(l.push(k),a.setAttribute("avalon-events",l.join(",")))):q(a,b,c),c},d.unbind=function(a,b,c){var e,f;if(1===a.nodeType)switch(e=a.getAttribute("avalon-events")||"",arguments.length){case 1:r(a,b,o),a.removeAttribute("avalon-events");break;case 2:e=e.split(",").filter(function(a){return-1===a.indexOf(b+":")}).join(","),a.setAttribute("avalon-events",e);break;default:f=b+":"+c.uuid,e=e.split(",").filter(function(a){return a!==f}).join(","),a.setAttribute("avalon-events",e),delete d.eventListeners[c.uuid]}else r(a,b,c)},k={},m=/^e/,n=!1,p={focus:!0,blur:!0},q=function(a,b,c,d){a.addEventListener(b,c,d)},r=function(a,b,c){a.removeEventListener(b,c)},t=/^[A-Z_]+$/,u.prototype={preventDefault:function(){var a=this.originalEvent||{};this.returnValue=!1,a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent||{};this.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){n=!0,this.stopPropagation()},toString:function(){return"[object Event]"}},d.fireDom=function(a,b,c){var f=e.createEvent("Events");f.initEvent(b,!0,!0),d.shadowCopy(f,c),a.dispatchEvent(f)},"onmouseenter"in g||d.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){j[a]={type:b,fn:function(b,c){return function(d){var e=d.relatedTarget;return e&&(e===b||16&b.compareDocumentPosition(e))?void 0:(delete d.type,d.type=a,c.call(this,d))}}}}),d.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(a,b){f[a]&&!j.animationend&&(j.animationend={type:b})}),void 0===e.onmousewheel&&(j.mousewheel={type:"wheel",fn:function(a,b){return function(a){a.wheelDeltaY=a.wheelDelta=a.deltaY>0?-120:120,a.wheelDeltaX=0,Object.defineProperty(a,"type",{value:"mousewheel"}),b.call(this,a)}}}),d.fn.bind=function(a,b,c){return this[0]?d.bind(this[0],a,b,c):void 0},d.fn.unbind=function(a,b,c){return this[0]&&d.unbind(this[0],a,b,c),this}},function(a,b,c){var h,d=c(4),e=c(35),f=d.document,g=[],i=function(a){for(h=!0;a=g.shift();)a(d)};d.ready=function(a){h?a(d):g.push(a)},d.ready(function(){e(f.body)}),new function(){d.browser&&("complete"===f.readyState?setTimeout(i):f.addEventListener("DOMContentLoaded",i),d.bind(window,"load",i))}},function(a,b,c){c(44),c(46),c(99),c(48),c(49),c(50),c(51),c(52),c(53),c(54),c(100),c(62),c(63),c(64),c(65),c(66),c(69)},function(a,b,c){var d=c(93),e=c(45);avalon.directive("attr",{diff:function(a,b,c){var g,h,i,d=a[c],f=b[c];if(d&&"object"==typeof d){if(Array.isArray(d)&&(d=avalon.mix.apply({},d)),b.dynamic[c]&&f){g={},h=!1;for(i in d)d[i]!==f[i]&&(h=!0,g[i]=d[i]);h&&(b[c]=d,b.changeAttr=g)}else b.changeAttr=b[c]=d;b.changeAttr&&e(b,this.update)}a!==b&&delete a[c]},update:d})},function(a,b,c){function p(a){var c,b,d;for(b=0;c=this.parsers[b++];)d=avalon.parsers[c],d&&(a=d.call(this,a));return a}var d=c(45),e=c(42),f=c(40),g=/\|\s*change\b/,h=/^(?:checkbox|radio)$/,i=/\|\s*debounce(?:\(([^)]+)\))?/,j=c(101),k=c(59),l=c(57),m=c(102),n=c(61),o="ms-duplex";avalon.directive("duplex",{priority:2e3,parse:function(a,b,c){var l,n,p,q,r,s,t,u,d=c.expr,j=b.props.type,k=c.param,m=!1;k=k?k.split("-").map(function(a){return"checked"===a&&(m=!0),a}):[],h.test(j)&&m&&(k=[],l="radio"),/input|textarea|select/.test(b.nodeName)?l||(l="select"===b.nodeName?"select":"checkbox"===j?"checkbox":"radio"===j?"radio":"input"):"contenteditable"in b.props&&(l="contenteditable"),n=!1,p=0,("input"===l||"contenteditable"===l)&&(q=!0,g.test(d)&&(n=!0),n||(r=d.match(i),r&&(p=parseInt(r[1],10)||300))),s=a.props["data-duplex-changed"],t=avalon.parseExpr(c,"duplex"),u=k.map(function(a){return avalon.quote(a)}),a[o]=f({type:l,vmodel:"__vmodel__",local:"__local__",debug:avalon.quote(c.name+"="+c.expr),isChecked:m,parsers:"["+u+"]",isString:!!q,isChanged:n,debounceTime:p,get:t,set:e.get("duplex:set:"+d),callback:s?avalon.parseExpr(s,"on"):"avalon.noop"})},diff:function(a,b){var c,e,f,g;if(b.dynamic[o]?c=b[o]:(c=b[o]=a[o],c.parse=p),a!==b&&(a[o]=null),e=c.get(c.vmodel),f=c.value,c.isString){if(e=c.parse(e),e+="",e===f)return}else if(Array.isArray(e)&&(g=!0,e+""===c.arrayHack))return;c.value=e,g&&(c.arayHack=e+""),d(b,this.update,"afterChange")},update:function(a,b){var c,d;a&&1===a.nodeType&&(b.dynamic[o]=1,a.__ms_duplex__||(a.__ms_duplex__=avalon.mix(b[o],{dom:a}),j(a,b),n(a,b)),c=a.__ms_duplex__,c.dom=a,!c.isString||avalon.msie||k!==!1||a.valueHijack||(a.valueHijack=l,d=setInterval(function(){avalon.contains(avalon.root,a)?a.valueHijack({type:"poll"}):clearInterval(d)},30)),m[c.type].call(c))}})},function(a,b,c){function i(a,b){var f,c={},e=b["ms-duplex"];switch(e.update=d,e.type){case"radio":case"checkbox":c.click=d;break;case"select":c.change=d;break;case"contenteditable":e.isChanged?c.blur=d:(g.webkitURL?c.webkitEditableContentChanged=d:g.MutationEvent&&(c.DOMCharacterDataModified=d),c.input=d);break;case"input":e.isChanged?c.change=d:(c.input=d,c.compositionstart=m,c.compositionend=n,avalon.msie&&(c.keyup=j))}/password|text/.test(b.props.type)&&(c.focus=k,c.blur=l,e.getCaret=o,e.setCaret=p);for(f in c)avalon.bind(a,f,c[f])}function j(a){var b=a.keyCode;91===b||b>15&&19>b||b>=37&&40>=b||d.call(this,a)}function k(){this.caret=!0}function l(){this.caret=!1}function m(){this.composing=!0}function n(a){this.composing=!1;var b=this;setTimeout(function(){d.call(b,a)},0)}function o(a){var b=0/0;return a.setSelectionRange&&(b=a.selectionStart),b}function p(a,b){a.value&&!a.readOnly&&(a.selectionStart=b,a.selectionEnd=b)}var g,d=c(57),e=c(6).getShortID;avalon.msie,g=avalon.window,avalon.document,e(k),e(l),e(m),e(n),e(j),e(d),a.exports=i},function(a){var c={input:function(){this.dom.value=this.value},radio:function(){var a,b;a=this.isChecked?!!this.value:this.value+""===this.dom.value,b=this.dom,b.checked=a},checkbox:function(){var d,e,a=!1,b=this.dom,c=b.value;for(d=0;d<this.value.length;d++)e=this.value[d],e+""===c&&(a=!0);b.checked=a},select:function(){var a=Array.isArray(this.value)?this.value.map(String):this.value+"";avalon(this.dom).val(a)},contenteditable:function(){this.dom.innerHTML=this.value,this.update.call(this.dom)}};a.exports=c},function(a,b,c){function m(){}function n(a,b,c){var f,k,n,o,p,q,r,s,t,d={};a.$skipArray&&(d=avalon.oneObject(a.$skipArray),delete a.$skipArray),f={},c=c||{},b=b||{},k={},n=l("$"),o=c.pathname||"",c.id=c.id||n,c.hashcode=n;for(p in a)g[p]||(s=f[p]=a[p],e(p,s,d)||(q=c.id+"."+p,r=o?o+"."+p:p,k[p]=h(q,r,b)));k.$model=j,t=new m,Object.defineProperties(t,k);for(p in f)t[p]=f[p],p in d?delete f[p]:f[p]=!0;return i(t,b,f,k,c),t}function p(a,b,c,d){var n,p,q,r,s,f={},k={},m=d.pathname;c=c||{};for(n in b)g[n]||(f[n]=b[n],e(n,b[n],o)||(r=Object.getOwnPropertyDescriptor(a,n),r&&r.get?k[n]=r:(p=d.id+"."+n,q=m?m+"."+n:n,k[n]=h(p,q,c))));for(n in a)delete a[n];d.hashcode=a.$hashcode||l("$"),k.$model=j,s=a,Object.defineProperties(s,k);for(n in f)k[n]||(s[n]=f[n]),f[n]=!0;return i(s,c,f,k,d),s}function q(a){var o,p,r,s,t,u,v,w,x,c={},d={},f={},j={},k={},n=avalon.slice(arguments),q="function"==typeof this&&this.isWidget;for(r=0;r<n.length;r++){s=n[r];for(t in s)u=s[t],"$skipArray"!==t?q&&-1!==n.indexOf(u)?(o=u,p=t):(v=Object.getOwnPropertyDescriptor(s,t),c[t]=u,d[t]&&avalon.isObject(u)&&delete d[t],v.set?d[t]=v:"function"!=typeof c[t]&&(f[t]=1)):Array.isArray(u)&&u.forEach(function(a){k[a]=1})}"function"==typeof this&&this(c,f);for(t in f)g[t]||d[t]||e(t,c[t],k)||(d[t]=h(a.$id+"."+t,t,j),d[t].set(c[t]));w=new m,Object.defineProperties(w,d);for(t in c)d[t]||(w[t]=c[t]),q&&o&&d[t]&&o.hasOwnProperty(t)&&(x=d[t].get,x.$decompose||(x.$decompose={}),x.$decompose[p+"."+t]=w),c[t]=!0;return i(w,j,c,d,{id:a.$id,hashcode:l("$"),master:!0}),w}function u(a,b){a.length!==b&&a.notify("length",a.length,b,!0)}var h,i,j,k,l,o,r,s,t,v,d=c(104),e=d.isSkip,f=d.$$midway,g=d.$$skipArray;delete g.$accessors,delete g.__data__,delete g.__proxy__,delete g.__const__,h=d.makeAccessor,i=d.initViewModel,j=d.modelAccessor,k=d.modelAdaptor,l=avalon.makeHashCode,f.masterFactory=n,o={},f.slaveFactory=p,f.mediatorFactory=avalon.mediatorFactory=q,r=d.__array__,s=Array.prototype,t=s.splice,r.removeAll=function(a){var c,d,b=this.length;if(Array.isArray(a))for(c=this.length-1;c>=0;c--)-1!==a.indexOf(this[c])&&t.call(this,c,1);else if("function"==typeof a)for(c=this.length-1;c>=0;c--)d=this[c],a(d,c)&&t.call(this,c,1);else t.call(this,0,this.length);u(this,b),this.notify()},v=["push","pop","shift","unshift","splice"],v.forEach(function(a){var b=s[a];r[a]=function(c,d){var g,h,i,j,l,m,n,o,e=[],f=this.length;if("splice"===a&&Object(this[0])===this[0])for(g=this.slice(c,d),h=s.slice.call(arguments,2),e=[c,d],i=0,j=h.length;j>i;i++)l=g[i],e[i+2]=k(h[i],l,l&&l.$events||{},{id:this.$id+".*",master:!0});else for(m=0,n=arguments.length;n>m;m++)e[m]=k(arguments[m],0,{},{id:this.$id+".*",master:!0});return o=b.apply(this,e),u(this,f),this.notify(),o}}),"sort,reverse".replace(avalon.rword,function(a){r[a]=function(){return s[a].apply(this,arguments),this.notify(),this}}),a.exports=avalon},function(a,b,c){function f(a){var c,d,e,g,b=avalon.type(a);if("array"===b){for(c=[],d=0;d<a.length;d++)c[d]=f(a[d]);return c}if("object"===b){e={};for(d in a)a.hasOwnProperty(d)&&(g=a[d],e[d]=g&&g.nodeType?g:f(g));return e}return a}function g(a,b,c){Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!1,configurable:!0})}function i(a,b,c,d,f){function i(a){return c[a]===!0}f.array?Object.defineProperty(a,"$model",h):g(a,"hasOwnProperty",i),g(a,"$id",f.id),g(a,"$hashcode",f.hashcode),g(a,"$track",Object.keys(c).sort().join(";;")),f.master===!0&&(g(a,"$run",k),g(a,"$wait",j),g(a,"$element",null),g(a,"$render",0),e(a,b))}function j(){this.$events.$$wait$$=!0}function k(){var b,c,a=this.$events;delete a.$$wait$$,a.$$dirty$$&&(delete a.$$dirty$$,avalon.rerenderStart=new Date,b=this.$id,c=b.indexOf("."),c>0?avalon.batch(b.slice(0,c)):avalon.batch(b))}var l,m,d=c(82),e=d.initEvents,h={get:function(){return f(this)},set:avalon.noop,enumerable:!1,configurable:!0};d.$$midway.hideProperty=g,d.$$midway.initViewModel=i,l={toJson:f,initViewModel:i,modelAccessor:h};for(m in d)l[m]=d[m];a.exports=l}])});